\chapter{Kwadratury Newtona-Cotesa dla ca≥ek podwÛjnych w prostokπcie}
W ca≥ym poprzednim rozdziale skupialiúmy siÍ na metodach ca≥kowania numerycznego. Odnosi≥y siÍ one jednak tylko do ca≥ek funkcji jednej zmiennej - zatem obliczenia wykonywano na pewnym przedziale domkniÍtym. Teraz chcemy poszerzyÊ naszπ wiedzÍ i przejúÊ o jeden krok dalej. Nasze rozwaøania zostanπ skierowane ponownie na te same, co poprzednio kwadratury. Znaczπca rÛønica polega≥a bÍdzie na tym, øe rozwaøymy ca≥ki funkcji dwÛch zmiennych. Wszystkie nasze dzia≥ania majπ na celu wy≥onienie najdok≥adniejszej metody wyznaczania wartoúci oznaczonych ca≥ek podwÛjnych przy pomocy prezentowanych algorytmÛw.  W dalszych badaniach wyrÛønimy trzy typy obszarÛw ca≥kowania, bÍdπ to:
\begin{itemize}
\item[a)] Obszar normalny ze wzglÍdu na zmiennπ $x$ i $y$
\item[b)] Obszar normalny tylko ze wzglÍdu na zmiennπ $x$
\item[c)] Obszar normalny tylko ze wzglÍdu na zmiennπ $y$
\end{itemize}

W celu kontynuacji rozwaøaÒ musimy przypomnieÊ niezbÍdnπ dla nas definicjÍ normalnoúci obszaru:
\begin{definition}(Obszar normalny)\\
O obszarze normalnym w przestrzeni kartezjaÒskiej $\re ^2$ 
\begin{itemize}
\item[a)]\label{ObszaryNormalneOx}wzglÍdem osi $OX$ (tj. wzglÍdem $x$) mÛwimy, gdy podzbiÛr p≥aszczyzny kartezjaÒskiej ograniczony jest przez wykresy pewnych dwÛch funkcji ciπg≥ych $u(x)$ i $v(x)$ oraz dwie proste rÛwnoleg≥e do osi $OY$.    
\item[b)]\label{ObszaryNormalneOy}wzglÍdem osi $OY$ (tj. wzglÍdem $y$) mÛwimy, gdy podzbiÛr p≥aszczyzny kartezjaÒskiej jest wyznaczany poprzez wykresy dwÛch rÛønych funkcji ciπg≥ych $l(y)$ i $k(y)$ oraz dwie proste, ktÛre sπ rÛwnoleg≥e do osi $OX$.
\item[c)]ze wzglÍdu na zmienne $x$ i $y$ mÛwimy, gdy podzbiÛr p≥aszczyzny kartezjaÒskiej jest ograniczony przez dwie proste rÛwnoleg≥e do osi $OX$ oraz dwie proste \mbox{rÛwnoleg≥e do $OY$} 

\end{itemize}

\section{WzÛr trapezÛw }\label{Rozdzial3.1_WzorTrapezow2DObszNormalny}
W podrozdziale \ref{Podrozdzial_WzorTrapezow} wyprowadziliúmy juø \textit{wzÛr trapezÛw} (\ref{wzorTrapezowBrakPodzialu}) i \textit{uogÛlniony wzÛr trapezÛw} (\ref{OgolnyWzorTrapezow}). Najbardziej interesuje nas drugi ze wspomnianych. Istnieje moøliwoúÊ rozszerzenia go na przypadek ogÛlny dotyczπcy funkcji dwÛch zmiennych. Zbadajmy wariant, dla ktÛrego obszar ca≥kowania jest normalny ze wzglÍdu na dwie zmienne.  

Niech ca≥kowanie odbywa siÍ na obszarze $\Omega=\{a\leq x\leq b ; c\leq y \leq d \}$. 
Przedzia≥ $[a,b]$ zostanie podzielony na $n$ podprzedzia≥Ûw postaci $[x_i,x_{i+1}]$ ($i=0,1,\ldots, n-1$). Podobnie bÍdzie dla $[c,d]$, podzielimy go na $m$ podprzedzia≥Ûw $[y_j,y_{j+1}]$ ($j=0,1,\ldots, m-1$). \mbox{W zwiπzku} z tym zajdzie nastÍpujπca prawid≥owoúÊ:
\vspace{-0.5cm}\begin{equation}\label{WezlyTrapez2}
\begin{array}{cc}
a=x_0 < x_1 < x_2\ldots < x_n=b, \\
c=y_0 < y_1 < y_2\ldots < y_m=d. \\
\end{array}
\end{equation} 
PostaÊ punktÛw $x_i$, $y_j$ naleøπcych do tych przedzia≥Ûw, jak rÛwnieø krokÛw $h_x$ i $h_y$ pomiÍdzy kolejnymi wartoúciami wÍz≥Ûw to:
\vspace{-0.5cm}\begin{equation}\label{WezlyNaObszarzeProstokatnymTrapez2}
\begin{array}{cc}
x_i=x_0+ih_x,\,\,\,\, h_x=\frac{b-a}{n} \,\,\,\,(i=0,1,\ldots ,n),\\
y_j=y_0+jh_y, \,\,\,\,h_y=\frac{d-c}{m} \,\,\,\,(j=0,1,\ldots ,m).\\
\end{array}
\end{equation}
Zapiszmy wzÛr (\ref{OgolnyWzorTrapezow}) w nieco innej postaci, ktÛra bÍdzie dla nas bardziej porÍczna, tzn.:
\begin{equation}\label{UogolnionyWzorTrapezow1Przeksztalcony}
\int\limits_a^b f(x) dx \approx \frac{h}{2}\sum\limits_{i=0}^{n-1}[f(x_i)+f(x_{i+1})]=\frac{h}{2}\left[f(x_0)+f(x_n)+2\sum\limits_{i=1}^{n-1} f(x_i) \right].
\end{equation} 
Kolejno weümy pewnπ oznaczonπ ca≥kÍ podwÛjnπ postaci \cite{klucz11}:
\begin{equation}\label{CalkaPodwojna}
I_{T2}=\int\limits_a^b\int\limits_c^d f(x,y)dydx=\int\limits_a^b g(x)dx\,\, ,
\end{equation} 
\end{definition}
\begin{flushleft}
przy czym ( rÛwnoúÊ (\ref{UogolnionyWzorTrapezow1Przeksztalcony}) rozszerzona o dodatkowπ zmiennπ\,)
\end{flushleft}
\begin{equation}\label{Wyjasnienie_g(x)_metodaTrapezow2}
g(x)=\int\limits_c^d f(x,y)dy\approx\frac{h_y}{2}\left[ f(x,y_0)+f(x,y_m)+2\sum\limits_{j=1}^{m-1}f(x,y_j)\right].
\end{equation}   
Podstawmy opisanπ przez rÛwnanie (\ref{Wyjasnienie_g(x)_metodaTrapezow2}) postaÊ $g(x)$ do (\ref{CalkaPodwojna}). Zaskutkuje to tym, øe:
\begin{equation}\label{SprowadzenieCalkiPodwDoPojedynczejZSumaTrapez2}
I_{T2}=\int\limits_a^b\int\limits_c^d f(x,y)dydx\approx\int\limits_a^b \frac{h_y}{2}\left[ f(x,y_0)+f(x,y_m)+2\sum\limits_{j=1}^{m-1}f(x,y_j)\right] dx  \,.
\end{equation}
W celu wyeliminowania potrzeby ca≥kowania w (\ref{SprowadzenieCalkiPodwDoPojedynczejZSumaTrapez2}) ponownie zostaje zastosowana \textit{metoda trapezÛw} z rÛwnania (\ref{UogolnionyWzorTrapezow1Przeksztalcony}) (rozszerzona w podobny sposÛb jak w (\ref{Wyjasnienie_g(x)_metodaTrapezow2})). Tym razem traktujemy $x$ jako zmiennπ, natomiast ca≥e wyraøenie podca≥kowe jako jednπ funkcjÍ. Sprowadza to nasz problem do nastÍpujπcego przypadku \cite{klucz11}:
\begin{equation}\label{CalkaPodwojnaJakoSumaTrapez2}
\begin{array}{cc}
I_{T2}\approx \frac{h_x}{2} \left\lbrace \frac{h_y}{2}\left[ f(x_0,y_0)+f(x_0,y_m)+2\sum\limits_{j=1}^{m-1}f(x_0,y_j)\right] \right.\\
+ \frac{h_y}{2}\left[ f(x_n,y_0)+f(x_n,y_m)+2\sum\limits_{j=1}^{m-1}f(x_n,y_j)\right] \\
+ \left. 2\sum\limits_{i=1}^{n-1}\frac{h_y}{2}\left[ f(x_i,y_0)+f(x_i,y_m)+2\sum\limits_{j=1}^{m-1}f(x_i,y_j)\right]
\right\rbrace.
\end{array}
\end{equation}
Ostatecznπ formπ \textbf{uogÛlnionego wzoru trapezÛw dla ca≥ek podwÛjnych w prostokπcie} jest:
\begin{equation}\label{UogolnionyWzorTrapezow2_obszarNormalny}
\begin{array}{cc}
I_{T2}\approx \frac{h_x h_y}{4}\left\lbrace f(x_0,y_0)+f(x_0,y_m)+f(x_n,y_0)+f(x_n,y_m)
+ 4\sum\limits_{i=1}^{n-1}\sum\limits_{j=1}^{m-1}f(x_i,y_j)\right.\\
\left. +2\sum\limits_{j=1}^{m-1}\left[f(x_0,y_j)+f(x_n,y_j)\right]
+ 2\sum\limits_{i=1}^{n-1}\left[f(x_i,y_0)+f(x_i,y_m)\right]\right\rbrace.
\end{array}
\end{equation}

WspÛ≥czynniki wagowe kwadratury opisanej powyøszym wzorem rozk≥adajπ siÍ wed≥ug pewnego schematu. Co oznacza, øe jeøeli rozpisalibyúmy (\ref{UogolnionyWzorTrapezow2_obszarNormalny}) tak, by uwzglÍdniÊ w nim wszystkie punkty wÍz≥owe postaci $(x_i,y_j)$ ( $i=0,1,\ldots,n$,\, \mbox{$j=0,1,\ldots,m$} ) naleøπce do pewnego obszaru prostokπtnego i spe≥niajπce (\ref{WezlyNaObszarzeProstokatnymTrapez2}), to odpowiednio wartoúci przy kolejnych $f(x_i,y_j)$ ( $i=0,1,\ldots,n\,\,\,,\,\,\,\, j=0,1,\ldots,m$ ) prezentowa≥yby siÍ nastÍpujπco \cite{klucz12}:
\begin{equation}\label{MacierzWspolczynnikowTrapez2}
\left[
\begin{array}{ccccccccc}
1 & 2 & 2 & 2 &\cdots & 2& 2& 2& 1\\
2 & 4 & 4 & 4 &\cdots & 4& 4& 4& 2\\
2 & 4 & 4 & 4 &\cdots & 4& 4& 4& 2\\
\vdots &\vdots &\vdots &\vdots & \ddots &\vdots &\vdots &\vdots &\vdots \\
2 & 4 & 4 & 4 &\cdots & 4& 4& 4& 2\\
1 & 2 & 2 & 2 &\cdots & 2& 2& 2& 1\\
\end{array}
\right]
\end{equation}
Przedstawiona macierz znaczπco upraszcza i przyspiesza rozpisywanie wzoru (\ref{UogolnionyWzorTrapezow2_obszarNormalny}). Dla przypadku \textit{uogÛlnionego wzoru trapezÛw dla ca≥ki pojedynczej} schemat ten ogranicza≥ siÍ jedynie do pierwszego wiersza (numeracja $i$ - od lewej do prawej, $j$ - od gÛry do do≥u).

Obliczanie wartoúci ca≥ki podwÛjnej \textit{metodπ trapezÛw} moøemy sprowadziÊ rÛwnieø do  sumowania objÍtoúci pewnych bry≥ trapezoidalnych. Innymi s≥owy - rozwaømy podzia≥ obszaru ca≥kowania $\Omega = [a,b] \times [c,d]$ na $n\cdot m$ podobszarÛw, co prezentuje Rysunek \ref{R4} zamieszczony poniøej:

\begin{figure}[H]
		\begin{center}
		\includegraphics[scale=0.7]{R4.eps}
		\end{center}
	   \caption{\textit{Metoda trapezÛw} dla ca≥ek podwÛjnych w obszarach prostokπtnych - podzia≥ obszaru ca≥kowania na podobszary }
	   {{\small èrÛd≥o: \cite{klucz10}}}
\label{R4}
\end{figure}
\begin{flushleft}
Jak widaÊ, kaødy z podobszarÛw jest wyznaczany przez cztery wierzcho≥ki $(x_i,y_j)$ (definicja $x_i$, $y_j$ taka jak w (\ref{WezlyNaObszarzeProstokatnymTrapez2})). Do obliczenia objÍtoúci kaødej z takich bry≥ trapezoidalnych potrzebne sπ nam pola podstawy ( juø je znamy - sπ one takie same dla kaødego podobszaru i wynoszπ $h_xh_y$), oraz odpowiadajπce dla nich wysokoúci. Te ostatnie okreúlimy jako úrednia arytmetyczna wartoúci funkcji $f(x,y)$ w czterech wierzcho≥kach definiujπcych kaødy z podobszarÛw ca≥kowania. Ostatecznie objÍtoúÊ kaødej bry≥y definiowa≥ bÍdzie nastÍpujπcy wzÛr \cite{klucz10}:
\end{flushleft}
\begin{equation}\label{ObjetoscDowolnegoTrapezoiduMetodaTrapezow2}
T2V_{i,j}=h_xh_y\left[\frac{f(x_{i},y_{j})+f(x_{i+1},y_{j})+f(x_{i},y_{j+1})+f(x_{i+1},y_{j+1})}{4}\right],
\end{equation}
przy czym $h_x$, $h_y$ opisane sπ w (\ref{WezlyNaObszarzeProstokatnymTrapez2}).\\ Rozszerzajπc rÛwnanie (\ref{ObjetoscDowolnegoTrapezoiduMetodaTrapezow2}), charakteryzujπce pojedynczπ objÍtoúÊ bry≥y na ca≥y obszar ca≥kowania dobrnÍlibyúmy do rÛwnoúci postaci  (\ref{UogolnionyWzorTrapezow2_obszarNormalny}). Analizujπc powyøsze zapiski, wnioskujemy iø zachodzi nastÍpujπca prawid≥owoúÊ: 
\begin{equation}\label{RownoscUogWzoruTrapezow2IWzoruZObjetosciami}
I_{T2V} = I_{T2}\approx \sum\limits_{i=0}^{n-1} \sum\limits_{j=0}^{m-1} h_xh_y\left[\frac{f(x_{i},y_{j})+f(x_{i+1},y_{j})+f(x_{i},y_{j+1})+f(x_{i+1},y_{j+1})}{4}\right].
\end{equation}
PorÛwnujπc macierz (\ref{MacierzWspolczynnikowTrapez2}) z Rysunkiem \ref{R4} zauwaøymy, øe elementy macierzy odzwierciedlajπ iloúÊ podobszarÛw, na styku ktÛrych umiejscowiony zosta≥ dany wÍze≥. Moøna to teø traktowaÊ jako informacjÍ ilu krotnie dany punkt wÍz≥owy zostaje uwzglÍdniony podczas sumowania w (\ref{RownoscUogWzoruTrapezow2IWzoruZObjetosciami}).

WzÛr (\ref{UogolnionyWzorTrapezow2_obszarNormalny}) podobnie jak dla przypadku ca≥ki pojedynczej moøna rÛwnieø otrzymaÊ wykorzystujπc \textit{wielomiany Lagrange'a $L_{1,1}(x,y)$}. Podamy jedynie zarys przekszta≥ceÒ, ktÛre doprowadzi≥yby nas do poøπdanego rezultatu: 
\begin{equation}\label{WzorTrapezowWielomianemL11}
\begin{array}{cc}
I_{T2L} = \int\limits_a^b \int\limits_c^d f(x,y) dydx\approx \int\limits_a^b \int\limits_c^d L_{1,1}(x,y) dydx = 
\sum\limits_{i=0}^{n-1} \sum\limits_{j=0}^{m-1}\int\limits_{x_i}^{x_{i+1}} \int\limits_{y_j}^{y_{j+1}} L_{1,1}(x,y) dydx =\\
\frac{h_xh_y}{4} \sum\limits_{i=0}^{n-1} \sum\limits_{j=0}^{m-1} \left[f(x_{i},y_{j})+f(x_{i+1},y_{j})+f(x_{i},y_{j+1})+f(x_{i+1},y_{j+1})\right].
\end{array}
\end{equation}
Ostatnie przejúcie mog≥o zostaÊ wykonane, poniewaø wynik dla kaødej ca≥ki $\int\limits_{x_i}^{x_{i+1}} \int\limits_{y_j}^{y_{j+1}} L_{1,1}(x,y) dydx$ jest takiej samej postaci, zmienia siÍ jedynie numer wÍz≥a branego pod uwagÍ. Dla przyk≥adu:
\begin{equation}
\begin{array}{cc}
\int\limits_{x_0}^{x_{1}} \int\limits_{y_0}^{y_{1}} L_{1,1}(x,y) dydx
 =
 \int\limits_{x_0}^{x_{1}} \int\limits_{y_0}^{y_{1}}\left( f(x_0,y_0)\left(\frac{x-x_1}{x_0-x_1}\frac{y-y_1}{y_0-y_1} \right)
 +f(x_0,y_1)\left(\frac{x-x_1}{x_0-x_1}\frac{y-y_0}{y_1-y_0} \right)\right.\\
\left. +f(x_1,y_0)\left(\frac{x-x_0}{x_1-x_0}\frac{y-y_1}{y_0-y_1} \right)
 +f(x_1,y_1)\left(\frac{x-x_0}{x_1-x_0}\frac{y-y_0}{y_1-y_0} \right)
 \right) dydx= \ldots =\\ 
 \frac{h_xh_y}{4}\left[f(x_{0},y_{0})+f(x_{1},y_{0})+f(x_{0},y_{1})+f(x_{1},y_{1})\right].
\end{array}
\end{equation}

Jak widaÊ istnieje wiele sposobÛw na to, by wyprowadziÊ poszukiwany przez nas \textit{dwuwymiarowy wzÛr trapezÛw}. Naj≥atwiejsza do zrozumienia i pÛüniejszego zaimplementowania okazuje siÍ na pierwszy rzut oka jego postaÊ z rÛwnoúci (\ref{RownoscUogWzoruTrapezow2IWzoruZObjetosciami}).\\ 
\newpage
Zechciejmy teraz wykorzystaÊ w praktyce zdobytπ wiedzÍ i rozwiπømy pewien przyk≥ad.

\begin{ex}(Wyznaczanie wartoúci ca≥ki podwÛjnej \textit{uogÛlnionym wzorem trapezÛw})\\
\textit{Wyznaczymy wartoúÊ przybliøonπ $\int\limits_0^{\frac{1}{2}}\int\limits_{\frac{1}{2}}^1 \frac{x+y}{x^2+y^2} dydx$ przy uøyciu uogÛlnionego wzoru trapezÛw dla ca≥ek podwÛjnych w prostokπcie. Przyjmijmy, øe przedzia≥y ca≥kowania dla obydwu zmiennych dzielimy na $n=m=2$ rÛwne podprzedzia≥y. }\\
Zgodnie z przyjÍtymi za≥oøeniami podzia≥ wyglπda nastÍpujπco:
\begin{center}
$x_0=0 , x_1=\frac{1}{4} , x_2=\frac{1}{2}, $\\
$y_0=\frac{1}{2} , y_1=\frac{3}{4} , y_2=1 $.\\
\end{center}
Wartoúciami krokÛw pomiÍdzy kolejnymi wÍz≥ami sπ: $h_x=\frac{x_2-x_0}{2}=\frac{1}{4}$, $h_y=\frac{y_2-y_0}{2}=\frac{1}{4}$.
Przejdümy teraz do g≥Ûwnych rachunkÛw prowadzπcych do wyniku, mianowicie:
\begin{center}
$\int\limits_0^{\frac{1}{2}}\int\limits_{\frac{1}{2}}^1 \frac{x+y}{x^2+y^2} dydx \approx
\frac{h_xh_y}{4}\left( f(x_0,y_0) + f(x_0,y_2) + f(x_2,y_0) + f(x_2,y_2)  + \right.$
$\left. + 4 f(x_1,y_1) + 2 f(x_0,y_1) + 2 f(x_2,y_1)+ 2 f(x_1,y_0) + 2 f(x_1,y_2)\right)=$
$=\frac{\frac{1}{16}}{4}\left( f(0,\frac{1}{2}) + f(0,1) + f(\frac{1}{2},\frac{1}{2}) + f(\frac{1}{2},1)  + \right.$
$\left. + 4 f(\frac{1}{4},\frac{3}{4}) + 2 f(0,\frac{3}{4}) + 2 f(\frac{1}{2},\frac{3}{4})+ 2 f(\frac{1}{4},\frac{1}{2}) + 2 f(\frac{1}{4},1)\right)=$\\
$=\frac{1}{64}\left(\frac{\frac{1}{2}}{\frac{1}{4}}+\frac{1}{1}+\frac{1}{\frac{2}{4}}+\frac{\frac{3}{2}}{\frac{5}{4}}+4 \frac{1}{\frac{10}{16}}+2\frac{\frac{3}{4}}{\frac{9}{16}}+2\frac{\frac{5}{4}}{\frac{13}{16}}+2\frac{\frac{3}{4}}{\frac{5}{16}}+2\frac{\frac{5}{4}}{\frac{17}{16}} \right)=$\\
$=\frac{1}{64}\left( 2+1+2+\frac{12}{10}+\frac{64}{10}+\frac{48}{18}+\frac{80}{26}+\frac{48}{10}+\frac{80}{34}\right)=0.398383295625$\\
\end{center}
Wynik dok≥adny otrzymany przy wykorzystaniu zaawansowanego narzÍdzia matematycznego wynosi $0.399181467986$. Bardzo szybko moøemy zauwaøyÊ, øe b≥πd wzglÍdny (oznaczmy go jako \textbf{BW}) nie jest znaczπcy i wynosi zaledwie $0.2\%$ : 
\begin{center}
$BW = \frac{|0.399181467986 - 0.398383295625|}{0,399181467986} \cdot 100\% \approx 0,19995\%\approx 0.2\% $ \\
\end{center}
Moøemy zatem bezwzglÍdnie stwierdziÊ, øe otrzymany wynik jest bardzo dok≥adny. 
\end{ex}

WidaÊ wprost, øe przeprowadzenie pe≥nych obliczeÒ moøe staÊ siÍ bardzo k≥opotliwe w przypadku, gdy funkcja podca≥kowa ma skomplikowanπ postaÊ, lub liczba wÍz≥Ûw liczona jest w dziesiπtkach bπdü setkach. W takim przypadku bardzo pomocna okaøe siÍ specjalna procedura napisana w jÍzyku \textit{Maple}, automatyzujπca ca≥y proces prowadzenia rachunkÛw. Skrypt z implementacjπ oraz jego pe≥en opis znajdziemy poniøej.

\begin{proc}(Wyznaczanie przybliøonych wartoúci ca≥ek podwÛjnych po obszarach normalnych przy uøyciu \textit{uogÛlnionego wzoru trapezÛw})\label{MAPLE_Trapez2ObszarNormalnyWartoscCalki}
\begin{verbatim}
> Trapez2 := proc (a, b, c, d, n, m) 
  local h, k, i, j, p, q, x, y, z, T2, WynikT2; 
  h := (b-a)/n; 
  k := (d-c)/m; 

  for i from 0 to n 
      do x := i -> a+i*h od;
 
  for j from 0 to m 
      do y := j -> c+j*k od; 

  for i from 0 to n 
      do for j from 0 to m 
            do z := (i, j) -> f(x(i), y(j)) od 
      od;

  T2 := (h*k)/4*(sum(sum(z(p, q)+z(p+1, q)+z(p, q+1)+z(p+1, q+1)
                                 , p = 0 .. n-1), q = 0 .. m-1)); 

  WynikT2 := evalf(T2) 
  end;
\end{verbatim}
\end{proc}

Przed wykorzystaniem zamieszczonej \textbf{Procedury \ref{MAPLE_Trapez2ObszarNormalnyWartoscCalki}} do wykonania g≥Ûwnych obliczeÒ, opiszmy zasadÍ jej dzia≥ania. Tak wiÍc pierwsza linia jest nag≥Ûwkiem procedury i odpowiada za definicjÍ jej nazwy oraz parametrÛw wejúciowych. Ich znaczenie jest nastÍpujπce:\\
\textit{a, b} - granice ca≥kowania po zmiennej $x$\\  
\textit{c, d} - granice ca≥kowania po zmiennej $y$\\
\textit{n} - iloúÊ podprzedzia≥Ûw przedzia≥u $[a,b]$, ktÛre sπ wyznaczane przez $n+1$ wÍz≥Ûw $x_i$\\ 
 %iloúÊ $x_i$ bÍdπcych wspÛ≥rzÍdnymi $x$-owymi wÍz≥Ûw na przedziale $[a,b]$\\
\textit{m} - iloúÊ podprzedzia≥Ûw przedzia≥u $[c,d]$, ktÛre sπ wyznaczane przez $m+1$ wÍz≥Ûw $y_j$\\
%iloúÊ $y_j$ bÍdπcych wspÛ≥rzÍdnymi $y$-owymi wÍz≥Ûw na przedziale $[c,d]$\\
(Zrozumienie ca≥ego powyøszego opisu ma kluczowe znaczenie w tym, by potrafiÊ prawid≥owo wywo≥aÊ procedurÍ \textit{Trapez2}.)
Kolejno zadeklarowane zosta≥y pomocnicze zmienne lokalne wykorzystane wewnπtrz algorytmu. NastÍpne dwa kroki odpowiadajπ za okreúlenie odleg≥oúci pomiÍdzy kolejnymi wÍz≥ami - zgodnie z tym co mÛwi rÛwnanie  (\ref{WezlyNaObszarzeProstokatnymTrapez2}). Dalsza czÍúÊ procedury sk≥adajπca siÍ kolejno z dwÛch pÍtli \textit{for} powoduje wyliczenie wartoúci wspÛ≥rzÍdnych $x_i$ oraz $y_j$, bÍdπcych po≥πczeniem (\ref{WezlyTrapez2}) oraz  (\ref{WezlyNaObszarzeProstokatnymTrapez2}). Trzecia z pÍtli uøyta w procedurze s≥uøy do obliczania i zapamiÍtywania wartoúci funkcji $f(x,y)$ w wyznaczonych przed chwilπ punktach wÍz≥owych. Najwaøniejszy fragment odpowiadajπcy bezpoúrednio za wyznaczenie wyniku ca≥kowania to ostatni blok z≥oøony z dwÛch zagnieødøonych pÍtli (przypisanie wartoúci do zmiennej \textit{T2}). Wykonywane w tym miejscu obliczenia sπ w pe≥ni zgodne ze wzorem (\ref{RownoscUogWzoruTrapezow2IWzoruZObjetosciami}) - to w≥aúnie on zosta≥ uøyty w implementacji. Ostatecznie wynik sumowania zostaje przekszta≥cony do klarownej postaci oraz zwrÛcony jako wartoúÊ \textit{WynikT2}.

Posiadajπc juø kompletne informacje dotyczπce kwestii sposobu dzia≥ania procedury, uøyjmy jej do obliczenia wartoúci dwÛch ca≥ek:
\begin{itemize}
\item[a)] $\int\limits_0^\frac{1}{2}\int\limits_\frac{1}{2}^1 \frac{x+y}{x^2+y^2} dydx$
\item[b)] $\int\limits_0^1\int\limits_1^2 e^\frac{x^2}{y^3} dydx$
\end{itemize}
Otrzymane wyniki zaprezentujemy w poniøszych tabelach. Przyjmijmy, øe $n$ oznacza≥o bÍdzie iloúÊ podzia≥Ûw przedzia≥u ca≥kowania dla zmiennej $x$, $m$ dla zmiennej $y$, zaú $W_{trapez2}$ to wynik \textit{Trapez2} dla coraz wiÍkszych wartoúci $n$ i $m$. Ponadto niech \textit{$BBT2_{n,m}$} opisuje b≥πd bezwzglÍdny przybliøenia wartoúci ca≥ki podwÛjnej procedurπ \textit{Trapez2}, przy jej wywo≥aniu dla pewnych parametrÛw $n$ i $m$. Dodatkowo \textit{$BWT2_{n,m}$} to wielkoúÊ b≥Ídu wzglÍdnego jakim jest obciπøony ten sam wynik wykonania \textit{Trapez2}, co w przypadku wyliczania \textit{$BBT2_{n,m}$}.
\begin{definition}(B≥πd wzglÍdny)\\
B≥πd wzglÍdny informuje nas o ile procent wartoúÊ zmierzona odbiega od wartoúci dok≥adnej. Wyliczamy go ze wzoru:
$$BW=\frac{BB}{x}\cdot 100\%=\frac{|x-\widehat{x}|}{x}\cdot100\% \,,$$ 
gdzie $x$ - wartoúÊ dok≥adna, $\widehat{x}$ - wartoúÊ oszacowana, $BB$ - b≥πd bezwzglÍdny pomiaru.  
\end{definition}

\hspace{-0.6cm}WartoúÊ dok≥adna ca≥ki z przyk≥adu a) jest rÛwna $0.399181467986$ , wiÍc:. 
%Wyniki wyznaczone procedurπ \ref{MAPLE_Trapez2ObszarNormalnyWartoscCalki} prezentujπ siÍ nastÍpujπco:\\
\begin{table}[h!]
\caption{Wyniki pomiaru dok≥adnoúci przybliøenia wartoúci ca≥ki a) procedurπ \textit{Trapez2}}
\hspace{-5.4cm}{\footnotesize èrÛd≥o: Opracowanie w≥asne\\}
\centering
 \begin{tabular}{|c|c|c|c|c|} 
 \hline
 $\mathbf{n}$ &$\mathbf{m}$ & $\mathbf{W_{trapez2}}$ & $\mathbf{BBT2_{n,m}}$ &$\mathbf{BWT2_{n,m}}$ \\ %[0.5ex] 
 \hline \hline
 2&4 &0.393439318989  &0.005742148997  &1.43848085583 \%  \\  
  \hline 
 4&4 &0.399131958147  &0.000049509839  &0.01240284005 \% \\ 
  \hline
 8&4 &0.400532451617  &0.001350983631  &0.33843846454 \% \\ 
  \hline 
 16&20 &0.399140325036  &0.000041142950  &0.01030682867\% \\ 
  \hline 
 30&20 &0.399221938576  &0.000040470590  &0.01013839400 \% \\ 
  \hline 
 60&20 &0.399246265075  &0.000064797089  &0.00006479709 \% \\ 
  \hline 
 90&50 &0.399189533066  &0.000008065080  &0.00202040441 \% \\ 
  \hline
 120&50 &0.399191108640  &0.000009640654  &0.00241510560 \% \\ 
  \hline 
 150&50 &0.399191837902  &0.000010369916  &0.00259779495 \% \\ 
  \hline 
 180&100 &0.399183484399  &0.000002016413  &0.00050513692 \% \\ 
  \hline
 200&100 &0.399183655444  &0.000002187458  &0.00054798585 \% \\ 
  \hline 
 230&100 &0.399183833262  &0.000002365276  &0.00059253151 \% \\  
  \hline 
 260&200 &0.399181765688  &0.000000297702  &0.00007457811 \% \\ 
   \hline 
 300&200 &0.399181873075  &0.000000405089  &0.00010147991 \% \\ 
  \hline               
 400&200 &0.399182014858  &0.000000546872  &0.00013699834 \%  \\%[0.5ex] 
 \hline 
 \end{tabular}\\ \hfill
 
 \label{WynikiZProceduryTrapez2a}
\end{table}

\hspace{-0.6cm}Ca≥ka z podpunktu b) wynosi dok≥adnie $1.14782135872$ , zatem:. 
\begin{table}[h!]
\caption{Wyniki pomiaru dok≥adnoúci przybliøenia wartoúci ca≥ki b) procedurπ \textit{Trapez2}}
\hspace{-5.4cm}{\footnotesize èrÛd≥o: Opracowanie w≥asne\\}
\centering
 \begin{tabular}{|c|c|c|c|c|} 
 \hline
 $\mathbf{n}$ &$\mathbf{m}$ & $\mathbf{W_{trapez2}}$ & $\mathbf{BBT2_{n,m}}$ &$\mathbf{BWT2_{n,m}}$ \\ %[0.5ex] 
  \hline \hline
 2&4 &1.18640582739  &0.03858446867  &0.0434283084 \%  \\  
  \hline 
 4&4 &1.16438017521  &0.01655881649  &1.4426301065 \% \\ 
  \hline
 8&4 &1.15874680449  &0.01092544578  &0.9518420002 \% \\ 
  \hline 
 16&20 &1.14862392499  &0.00080256627  &0.0699208342 \% \\ 
  \hline 
 30&20 &1.14831983812  &0.00049847940  &0.0434283084 \% \\ 
  \hline 
 60&20 &1.14822915032  &0.00040779164  &0.0355274483 \% \\ 
  \hline 
 90&50 &1.14789525293  &0.00007389417  &0.0064377762 \% \\ 
  \hline
 120&50 &1.14788939950  &0.00006804078  &0.0059278196 \% \\ 
  \hline 
 150&50 &1.14788669031  &0.00006533159  &0.0056917907 \% \\ 
  \hline 
 180&100 &1.14783983476  &0.00001847604 &0.0016096616 \% \\ 
  \hline
 200&100 &1.14783919935  &0.00001784063  &0.0015543037 \% \\ 
  \hline 
 230&100 &1.14783853899  &0.00001718027  &0.0014967721 \% \\  
  \hline 
 260&200 &1.14782674438  &0.00000538566  &0.0004692072 \% \\ 
   \hline 
 300&200 &1.14782634606  &0.00000498734  &0.0004345049 \% \\ 
  \hline               
 400&200 &1.14782581891  &0.00000446019  &0.0003885788 \%  \\%[0.5ex] 
 \hline 
 \end{tabular}\\ \hfill
 \label{WynikiZProceduryTrapez2b}
\end{table}

Analizujπc zgromadzone juø wyniki wykonania procedury, oraz wyznaczone na ich podstawie wartoúci $\mathbf{BBT2_{n,m}}$ i $\mathbf{BWT2_{n,m}}$ zauwaøamy pewnπ prawid≥owoúÊ. W miarÍ wzrostu liczby podzia≥Ûw ($\mathbf{n}$ i $\mathbf{m}$) przedzia≥Ûw ca≥kowania wartoúci b≥ÍdÛw odznaczajπ siÍ tendencjπ spadkowπ. SzczegÛlnie widoczna jest ona na przyk≥adzie b). W przyk≥adzie a) moøna dostrzec jednak, øe b≥Ídy z kolejnego pomiaru sπ czÍsto wiÍksze niø te z poprzedniego,  pomimo to jednak rÛwnieø zauwaøalny jest ich stopniowy spadek. Sytuacja zaobserwowana dla pomiarÛw w Tablicy \ref{WynikiZProceduryTrapez2a} jest w duøej mierze spowodowana postaciπ rÛwnania funkcji podca≥kowej oraz sposobem dzia≥ania algorytmu. W miarÍ tego, im wiÍcej jest deformacji powierzchni wykresu owej funkcji, tym czÍúciej pojawiπ siÍ wahania wielkoúci b≥Ídu dla coraz to wiÍkszej liczby wÍz≥Ûw. Jak widaÊ sytuacja nie jest juø tak oczywista, jak by≥a w przypadku uøycia \textit{wzoru trapezÛw} dla ca≥ek pojedynczych - tam wzrost iloúci punktÛw wÍz≥owych zapewnia≥ sta≥y wzrost dok≥adnoúci wyniku.   


\section{WzÛr Simpsona}
Podobnie jak w rozdziale \ref{Rozdzial3.1_WzorTrapezow2DObszNormalny} moøemy rÛwnieø rozszerzyÊ \textit{wzÛr Simpsona} na przypadek, gdzie mamy do czynienia z wyznaczaniem wartoúci ca≥ek podwÛjnych w obszarach normalnych ze wzglÍdu na dwie zmienne. W tym celu moøemy wykorzystaÊ na przyk≥ad \textit{uogÛlniony wzÛr Simpsona} (\ref{wzorSimpsonaZPodzialami})    lub \textit{wielomian Lagrange'a} $L_{2,2}(x,y)$ zbudowany w oparciu o wzÛr (\ref{WielomianInterpolacyjnyLagrangea2}). 

Rozwaømy pewien obszar ca≥kowania $\Delta=\{a\leq x\leq b ; c\leq y \leq d \}$. 
Przedzia≥ $[a,b]$ zostanie podzielony na $N=2n$, $(n=1,2,\ldots)$ podprzedzia≥Ûw postaci \mbox{$[x_{2i},x_{2i+1}] (i=0,\frac{1}{2},\ldots, \frac{2n-1}{2})$}. Podobnie bÍdzie dla $[c,d]$, podzielimy go na $M=2m$, $(m=1,2,\ldots)$ podprzedzia≥Ûw \mbox{$[y_{2j},y_{2j+1}]$ ($j=0,\frac{1}{2},\ldots, \frac{2m-1}{2}$).} Z tego faktu wynika≥a bÍdzie nastÍpujπca prawid≥owoúÊ:
\vspace{-0.5cm}\begin{equation}\label{WezlySimpson2}
\begin{array}{cc}
a=x_0 < x_1 < x_2\ldots < x_{2n}=b, \\ 
c=y_0 < y_1 < y_2\ldots < y_{2m}=d. \\
\end{array}
\end{equation}
Dodatkowo zauwaømy, øe postaÊ punktÛw $x_i$, $y_j$ naleøπcych do tych przedzia≥Ûw, jak rÛwnieø krokÛw $h_x$ i $h_y$ pomiÍdzy kolejnymi wartoúciami wÍz≥Ûw to:
\vspace{-0.5cm}\begin{equation}\label{WezlyNaObszarzeProstokatnymSimpson2}
\begin{array}{cc}
x_i=x_0+ih_x,\,\,\,\, h_x=\frac{b-a}{N} \,\,\,\,(i=0,1,\ldots ,N=2n), \\
y_j=y_0+jh_y, \,\,\,\,h_y=\frac{d-c}{M} \,\,\,\,(j=0,1,\ldots ,M=2m).\\
\end{array}
\end{equation}

Tak samo jak zrobiliúmy to dla przypadku \textit{wzoru trapezÛw}, wykonajmy rÛwnieø przekszta≥cenie \textit{uogÛlnionego wzoru Simpsona} (\ref{wzorSimpsonaZPodzialami}) do postaci takiej, øe bÍdzie dla nas znacznie porÍczniejsza w dalszych rozwaøaniach. W tym momencie naleøy powiedzieÊ, øe zmianie ulegajπ indeksy pod znakiem sumowania. Ujednolicajπc oznaczenia tak, by wyglπda≥y jak dla \textit{wzoru trapezÛw} w (\ref{wzorSimpsonaZPodzialami}) zastÍpujemy $m$ przez $n$. Pozosta≥e - dotyczπce punktÛw wÍz≥owych i wielkoúci krokÛw pomiÍdzy nimi zosta≥y na nowo zdefiniowane na poczπtku tego podrozdzia≥u. W zwiπzku z tym przekszta≥cone rÛwnanie (\ref{wzorSimpsonaZPodzialami}) ze zmienionymi indeksami wyglπda nastÍpujπco:  
\begin{equation}\label{UogolnionyWzorSimpsona1Rozdzial3}
\begin{array}{cc}
\int\limits_a^b f(x)dx = \sum\limits_{i=0}^{n-1} \int\limits_{x_{2i}}^{x_{2i+2}} f(x) dx \approx \\
\frac{h}{3}\sum\limits_{i=0}^{n-1}\left(f(x_{2i})+4f(x_{2i+1})+f(x_{2i+2})\right)=\\
\frac{h}{3}\left(f(x_{0})+4\sum\limits_{i=0}^{n-1}f(x_{2i+1})+2\sum\limits_{i=0}^{n-2}f(x_{2i+2}) + f(x_{2n})\right).
\end{array}
\end{equation}     
Weümy teraz pewnπ podwÛjnπ ca≥kÍ oznaczonπ postaci \cite{klucz11} :
\begin{equation}\label{CalkaPodwojnaMetodaSimpsona}
I_{S2}=\int\limits_{a}^{b}\int\limits_{c}^{d}f(x,y)dydx=\int\limits_{a}^{b} g(x)dx \,\,,
\end{equation}
gdzie $g(x)$ to rozszerzone do dwÛch zmiennych rÛwnanie (\ref{UogolnionyWzorSimpsona1Rozdzial3})   
\begin{equation}\label{Funkcja_g(x)_CalkaPodwojnaMetodaSimpsona}
\begin{array}{cc}
g(x)=\int\limits_{c}^{d}f(x,y)dy\approx \\
\frac{h_y}{3}\left(f(x,y_0)+4\sum\limits_{j=0}^{m-1}f(x,y_{2j+1})+2\sum\limits_{j=0}^{m-2}f(x,y_{2j+2})+f(x,y_{2m}) \right).
\end{array}
\end{equation}  
Po podstawieniu (\ref{Funkcja_g(x)_CalkaPodwojnaMetodaSimpsona}) do (\ref{CalkaPodwojnaMetodaSimpsona}) otrzymamy:
\begin{equation}\label{WzorSimpsona2JednaCalka}
\begin{array}{cc}
I_{S2}=\int\limits_{a}^{b}\int\limits_{c}^{d}f(x,y)dydx \approx \\ 
\int\limits_{a}^{b} \frac{h_y}{3}\left(f(x,y_0)+4\sum\limits_{j=0}^{m-1}f(x,y_{2j+1})+2\sum\limits_{j=0}^{m-2}f(x,y_{2j+2})+f(x,y_{2m}) \right).
\end{array}
\end{equation}
W celu wyeliminowania z rÛwnania (\ref{WzorSimpsona2JednaCalka}) koniecznoúci ca≥kowania, moøemy ponownie zastosowaÊ \textit{uogÛlniony wzÛr Simpsona} - tak jak zrobiliúmy to w przypadku (\ref{Funkcja_g(x)_CalkaPodwojnaMetodaSimpsona}).
\newpage
\hspace{-1cm}Realizacja zaproponowanego pomys≥u doprowadza (\ref{WzorSimpsona2JednaCalka}) do poniøszej formy:
\begin{equation}
\begin{array}{cc}
I_{S2}\approx \frac{h_x}{3}\left\lbrace \frac{h_y}{3} \left(f(x_0,y_0)+f(x_0,y_{2m})+4\sum\limits_{j=0}^{m-1}f(x_0,y_{2j+1})+2\sum\limits_{j=0}^{m-2}f(x_0,y_{2j+2}) \right) \right.\\
+ \frac{h_y}{3} \left(f(x_{2n},y_0)+f(x_{2n},y_{2m})+4\sum\limits_{j=0}^{m-1}f(x_{2n},y_{2j+1})+2\sum\limits_{j=0}^{m-2}f(x_{2n},y_{2j+2}) \right)\\
+4\sum\limits_{i=0}^{n-1} \frac{h_y}{3} \left(f(x_{2i+1},y_0)+f(x_{2i+1},y_{2m})+4\sum\limits_{j=0}^{m-1}f(x_{2i+1},y_{2j+1})+2\sum\limits_{j=0}^{m-2}f(x_{2i+1},y_{2j+2}) \right)\\
\left. +2\sum\limits_{i=0}^{n-2} \frac{h_y}{3} \left(f(x_{2i+2},y_0)+f(x_{2i+2},y_{2m})+4\sum\limits_{j=0}^{m-1}f(x_{2i+2},y_{2j+1})+2\sum\limits_{j=0}^{m-2}f(x_{2i+2},y_{2j+2}) \right)\right\rbrace.\\
\end{array}
\end{equation}
Po dokonaniu moøliwie najlepszego przekszta≥cenia - ostatecznπ postaciπ wyprowadzonego, \textbf{uogÛlnionego wzoru Simpsona dla ca≥ek podwÛjnych po obszarach normalnych wzglÍdem dwÛch zmiennych} jest: 
\begin{equation}\label{UogolnionyWzorSimpsona2_obszarNormalny}
\begin{array}{cc}
I_{S2}\approx \frac{h_x h_y}{9} \left\lbrace f(x_0,y_0)+f(x_0,y_{2m})+f(x_{2n},y_0)+f(x_{2n},y_{2m})\right.\\

+2\left(\sum\limits_{j=0}^{m-2}\left[ f(x_0,y_{2j+2}) + f(x_{2n},y_{2j+2})\right] + \sum\limits_{i=0}^{n-2} \left[f(x_{2i+2},y_0)+f(x_{2i+2},y_{2m})\right]\right)\\
+4\left( \sum\limits_{j=0}^{m-1}\left[ f(x_0,y_{2j+1}) + f(x_{2n},y_{2j+1}) \right] + \sum\limits_{i=0}^{n-1} \left[f(x_{2i+1},y_0)+f(x_{2i+1},y_{2m}) \right]\right)\\
+8\left( \sum\limits_{i=0}^{n-1} \sum\limits_{j=0}^{m-2}f(x_{2i+1},y_{2j+2}) + \sum\limits_{i=0}^{n-2}\sum\limits_{j=0}^{m-1}f(x_{2i+2},y_{2j+1}) \right)\\
 +4 \sum\limits_{i=0}^{n-2}\sum\limits_{j=0}^{m-2}f(x_{2i+2},y_{2j+2}) + 16 \sum\limits_{i=0}^{n-1}\sum\limits_{j=0}^{m-1}f(x_{2i+1},y_{2j+1})\}.

\end{array}
\end{equation}

Tak jak zauwaøyliúmy wczeúniej dla \textit{uogÛlnionego wzoru trapezÛw} (\ref{UogolnionyWzorTrapezow2_obszarNormalny}), rozpisanie  (\ref{UogolnionyWzorSimpsona2_obszarNormalny}) w sposÛb taki, by uwzglÍdniono w nim wszystkie moøliwe punkty wÍz≥owe postaci $(x_{2i},y_{2j})$ ( $i=0,1,\ldots, n$\,\,,\, \mbox{$j=0,1,\ldots, m$} ) naleøπce do pewnego obszaru prostokπtnego oraz spe≥niajπce rÛwnanie (\ref{WezlyNaObszarzeProstokatnymSimpson2}), skutkowa≥oby tym, øe wartoúci przy kolejnych $f(x_{2i},y_{2j})$ ($i=0,1,\ldots,n\,\,,\,\,\,\, j=0,1,\ldots,m$ ) rozk≥ada≥yby siÍ wed≥ug pewnego schematu powsta≥ego w wyniku mnoøenia dwÛch nastÍpujπcych wektorÛw:

$$\qquad A= \left[
        \begin{array}{ccccccc}
         1 & 4 & 2 & 4 & \cdots & 4 & 1 \\
         \end{array}
      \right]
      \qquad
$$
$$ \,\,B= \left[
		\begin{array}{ccccccc}
         1 & 4 & 2 & 4 & \cdots & 4 & 1 \\
         \end{array}       
     \right]^T 
$$
W zwiπzku z tym rezultat operacji $A \times B$ jest nastÍpujπcy \cite{klucz12}:

\begin{equation}\label{MacierzWspolczynnikowSimpson2}
A \times B = \left[
\begin{array}{ccccccccc}
1 & 4 & 2 & 4 &\cdots & 4& 2& 4& 1\\
4 & 16 & 8 & 16 &\cdots & 16& 8& 16& 4\\
2 & 8 & 4 & 8 &\cdots & 8& 4& 8& 2\\
\vdots &\vdots &\vdots &\vdots & \ddots &\vdots &\vdots &\vdots &\vdots \\
2 & 8 & 4 & 8 &\cdots & 8& 4& 8& 2\\
4 & 16 & 8 & 16 &\cdots & 16& 8& 16& 4\\
1 & 4 & 2 & 4 &\cdots & 4& 2& 4& 1\\
\end{array}
\right]
\end{equation}\\
Zaprezentowana macierz diametralnie upraszcza zapis rÛwnania (\ref{UogolnionyWzorSimpsona2_obszarNormalny}). Pewien jej fragment, a dok≥adniej pierwszy wiersz, pojawi≥ siÍ juø dla przypadku \textit{uogÛlnionego wzoru Simpsona} (\ref{wzorSimpsonaZPodzialami}) dla ca≥ki pojedynczej.

Przybliøanie wartoúci ca≥ki podwÛjnej obliczanej \textit{metodπ Simpsona} moøna rÛwnieø sprowadziÊ do sumowania objÍtoúci pewnych bry≥ parabolicznych. Weümy podzia≥ obszaru ca≥kowania $\Omega = [a,b] \times [c,d]$ na  $2n\cdot 2m$ podobszarÛw, co dok≥adniej \mbox{prezentuje Rysunek \ref{R5}:}
\begin{figure}[H]
		\begin{center}
		\includegraphics[scale=0.6]{R5.eps}
		\end{center}
	   \caption{\textit{Metoda Simpsona} dla ca≥ek podwÛjnych po obszarze normalnym wzglÍdem dwÛch zmiennych - podzia≥ obszaru ca≥kowania na podobszary}
	   {\small èrÛd≥o:  \cite{klucz10}}
\label{R5}
\end{figure}
\newpage
\hspace{-1cm}Kaødy z podobszarÛw obszaru $\Omega$ jest ograniczony pogrubionπ krawÍdziπ i sk≥ada siÍ zawsze z dok≥adnie czterech mniejszych podpodobszarÛw wyznaczanych przez dziewiÍÊ wÍz≥Ûw ($x_{2i},y_{2j}$) ( $i=0,1,\ldots, n$\,\,,\, \mbox{$j=0,1,\ldots, m$} ). ObjÍtoúÊ dowolnego spoúrÛd wiÍkszych wyraøa siÍ wzorem:

\begin{equation}\label{ObjetoscPodobszaruSimpson2D}
\begin{array}{c}
S2V_{i,j}=\frac{h_xh_y}{9}\left[f(x_{2i},y_{2j})+4 f(x_{2i+1},y_{2j})+f(x_{2i+2},y_{2j})+\right.\\
4 f(x_{2i},y_{2j+1})+16 f(x_{2i+1},y_{2j+1})+4 f(x_{2i+2},y_{2j+1})+\\
\left.f(x_{2i},y_{2j+2})+4 f(x_{2i+1},y_{2j+1})+ f(x_{2i+2},y_{2j+2})\right]
\end{array}
\end{equation}\\       
WspÛ≥czynniki, ktÛre pojawi≥y siÍ w powyøszym zapisie przy wartoúciach funkcji $f(x,y)$  nie sπ przypadkowe i tak intuicyjne jak dla \textit{wzoru TrapezÛw}. Powsta≥y one po przemnoøeniu \textit{'okrojonej'} wersji wektorÛw $A$ i $B$, ktÛrych to uøywaliúmy do zbudowania macierzy (\ref{MacierzWspolczynnikowSimpson2}). Sπ one postaci:

$$\qquad a= \left[
        \begin{array}{ccc}
         1 & 4 & 1 \\
         \end{array}
      \right],
      \qquad
 \,\,b= \left[
		\begin{array}{c}
         1 \\
         4\\
         1\\
         \end{array}       
     \right]. 
$$ 
W zwiπzku z tym ich iloczyn to:

\begin{equation}\label{MacierzWspolczynnikowSimpson2_objetosc1podobszaru}
a \times b = \left[
\begin{array}{ccc}
 		 1 & 4 & 1 \\
         4 & 16 & 4 \\
         1 & 4 & 1 \\
\end{array}
\right].
\end{equation}\\
 
Rozszerzajπc zakres sumowania z jednego podobszaru na ca≥π  $\Omega$ nasz wzÛr przyjmie ostatecznie bardziej czytelnπ formÍ:
\begin{equation}\label{SumaObjetosciDlaCalegoObszaruSimpson2D}
\begin{array}{c}
I_{S2V}=I_{S2}\approx\frac{h_xh_y}{9}\sum\limits_{i=0}^{n-1}\sum\limits_{j=0}^{m-1}\left[f(x_{2i},y_{2j})+4 f(x_{2i+1},y_{2j})+f(x_{2i+2},y_{2j})+\right.\\
4 f(x_{2i},y_{2j+1})+16 f(x_{2i+1},y_{2j+1})+4 f(x_{2i+2},y_{2j+1})+\\
\left.f(x_{2i},y_{2j+2})+4 f(x_{2i+1},y_{2j+1})+ f(x_{2i+2},y_{2j+2})\right].
\end{array}
\end{equation}   
Zauwaømy, øe (\ref{SumaObjetosciDlaCalegoObszaruSimpson2D}) oraz (\ref{UogolnionyWzorSimpsona2_obszarNormalny}) sπ rÛwnowaøne. Moøna siÍ o tym przekonaÊ rozpisujπc (\ref{SumaObjetosciDlaCalegoObszaruSimpson2D}) juø dla kilku pierwszych wartoúci $i$ oraz $j$.

Zaprezentowane dotychczas sposoby wyprowadzania \textit{uogÛlnionego wzoru Simpsona} nie sπ jedynymi nam znanymi. Pokaømy, øe (zgodnie ze stwierdzeniem z poczπtku rozdzia≥u) to samo rÛwnanie moøemy otrzymaÊ poprzez ca≥kowanie \textit{wielomianu Lagrange'a} $L_{2,2}(x,y)$. Ca≥ka taka jest postaci:
\begin{equation}\label{WzorSimpsona2DZCalkiL22}
\int\limits_{x_0}^{x_2} \int\limits_{y_0}^{y_2} L_{2,2}(x,y) dydx=\int\limits_{x_0}^{x_2} \int\limits_{y_0}^{y_2} \sum\limits_{i=0}^2 \sum\limits_{j=0}^2 f(x_i,y_j) \left(\prod\limits_{s=0, s\neq i}^2 \frac{x-x_s}{x_i-x_s}\prod\limits_{r=0, r\neq j}^2 \frac{y-y_r}{y_j-y_r}\right)dydx.
\end{equation}       
Przyjmujπc nastÍpujπce wartoúci $x_0=0$, $x_1=h$, $x_2=2h$, $y_0=0$, $y_1=k$ oraz $y_2=2k$ moøemy w (\ref{WzorSimpsona2DZCalkiL22}) wyszczegÛlniÊ dziewiÍÊ ca≥ek. Wyznaczenie ich spowoduje otrzymanie wspÛ≥czynnikÛw wystÍpujπcych przy wartoúciach funkcji $f(x_i,y_j)$ w kolejnych wÍz≥ach zgodnych z (\ref{MacierzWspolczynnikowSimpson2_objetosc1podobszaru}), tzn.:

\begin{small}
$$\int\limits_{x_0}^{x_2} \int\limits_{y_0}^{y_2} \frac{(x-x_1)(x-x_2)(y-y_1)(y-y_2)}{(x_0-x_1)(x_0-x_2)(y_0-y_1)(y_0-y_2)} dydx =\int\limits_{0}^{2h} \int\limits_{0}^{2k} \frac{(x-h)(x-2h)(y-k)(y-2k)}{(0-h)(0-2h)(0-k)(0-2k)} dydx = \frac{hk}{9}$$
$$\int\limits_{x_0}^{x_2} \int\limits_{y_0}^{y_2} \frac{(x-x_1)(x-x_2)(y-y_0)(y-y_2)}{(x_0-x_1)(x_0-x_2)(y_1-y_0)(y_1-y_2)} dydx =\int\limits_{0}^{2h} \int\limits_{0}^{2k} \frac{(x-h)(x-2h)(y-0)(y-2k)}{(0-h)(0-2h)(k-0)(k-2k)} dydx = \frac{4hk}{9}$$
$$\int\limits_{x_0}^{x_2} \int\limits_{y_0}^{y_2} \frac{(x-x_1)(x-x_2)(y-y_0)(y-y_1)}{(x_0-x_1)(x_0-x_2)(y_2-y_0)(y_2-y_1)} dydx =\int\limits_{0}^{2h} \int\limits_{0}^{2k} \frac{(x-h)(x-2h)(y-0)(y-k)}{(0-h)(0-2h)(2k-0)(2k-k)} dydx = \frac{hk}{9}$$

$$\int\limits_{x_0}^{x_2} \int\limits_{y_0}^{y_2} \frac{(x-x_0)(x-x_2)(y-y_1)(y-y_2)}{(x_1-x_0)(x_1-x_2)(y_0-y_1)(y_0-y_2)} dydx =\int\limits_{0}^{2h} \int\limits_{0}^{2k} \frac{(x-0)(x-2h)(y-k)(y-2k)}{(h-0)(h-2h)(0-k)(0-2k)} dydx = \frac{4hk}{9}$$
$$\int\limits_{x_0}^{x_2} \int\limits_{y_0}^{y_2} \frac{(x-x_0)(x-x_2)(y-y_0)(y-y_2)}{(x_1-x_0)(x_1-x_2)(y_1-y_0)(y_1-y_2)} dydx =\int\limits_{0}^{2h} \int\limits_{0}^{2k} \frac{(x-0)(x-2h)(y-0)(y-2k)}{(h-0)(h-2h)(k-0)(k-2k)} dydx = \frac{16hk}{9}$$
$$\int\limits_{x_0}^{x_2} \int\limits_{y_0}^{y_2} \frac{(x-x_0)(x-x_2)(y-y_0)(y-y_1)}{(x_1-x_0)(x_1-x_2)(y_2-y_0)(y_2-y_1)} dydx =\int\limits_{0}^{2h} \int\limits_{0}^{2k} \frac{(x-0)(x-2h)(y-0)(y-k)}{(h-0)(h-2h)(2k-0)(2k-k)} dydx = \frac{4hk}{9}$$

$$\int\limits_{x_0}^{x_2} \int\limits_{y_0}^{y_2} \frac{(x-x_0)(x-x_1)(y-y_1)(y-y_2)}{(x_2-x_0)(x_2-x_1)(y_0-y_1)(y_0-y_2)} dydx =\int\limits_{0}^{2h} \int\limits_{0}^{2k} \frac{(x-0)(x-h)(y-k)(y-2k)}{(2h-0)(2h-h)(0-k)(0-2k)} dydx = \frac{hk}{9}$$
$$\int\limits_{x_0}^{x_2} \int\limits_{y_0}^{y_2} \frac{(x-x_0)(x-x_1)(y-y_0)(y-y_2)}{(x_2-x_0)(x_2-x_1)(y_1-y_0)(y_1-y_2)} dydx =\int\limits_{0}^{2h} \int\limits_{0}^{2k} \frac{(x-0)(x-h)(y-0)(y-2k)}{(2h-0)(2h-h)(k-0)(k-2k)} dydx = \frac{4hk}{9}$$
$$\int\limits_{x_0}^{x_2} \int\limits_{y_0}^{y_2} \frac{(x-x_0)(x-x_1)(y-y_0)(y-y_1)}{(x_2-x_0)(x_2-x_1)(y_2-y_0)(y_2-y_1)} dydx =\int\limits_{0}^{2h} \int\limits_{0}^{2k} \frac{(x-0)(x-h)(y-0)(y-k)}{(2h-0)(2h-h)(2k-0)(2k-k)} dydx = \frac{hk}{9}$$

\end{small}\hfill\\
Tak jak wspomnieliúmy tuø przed przeprowadzeniem obliczeÒ, powyøej wyznaczone wspÛ≥czynniki tworzπ macierz (\ref{MacierzWspolczynnikowSimpson2_objetosc1podobszaru}). Wyjaúniajπc - kaøde kolejne trzy wartoúci poczπwszy od pierwszej, czwartej i siÛdmej tworzπ jeden osobny jej wiersz. Obliczenia te sπ bardzo pracoch≥onne, zosta≥y wiÍc zaprezentowane tylko w celach poglπdowych.  

Wykorzystujπc (\ref{UogolnionyWzorSimpsona2_obszarNormalny}) lub samπ macierz (\ref{MacierzWspolczynnikowSimpson2}) wyznaczmy przybliøonπ wartoúÊ przyk≥adowej ca≥ki.

\begin{ex}(Wyznaczanie wartoúci ca≥ki podwÛjnej \textit{wzorem Simpsona})\\\hfill
\textit{Obliczymy  $\int\limits_{0}^{\frac{1}{2}}\int\limits_{\frac{1}{2}}^1 \frac{x+y}{x^2+y^2}dydx$ wykorzystujπc uogÛlniony wzÛr Simpsona dla ca≥ek podwÛjnych po obszarach prostokπtnych. Dla rozpatrywanego przypadku przyjmijmy, øe przedzia≥ ca≥kowania zarÛwno dla zmiennej $x$ jak i $y$ zostanie podzielony na dwa podwÛjne podprzedzia≥y wyznaczone przez rÛwno odleg≥e wÍz≥y. }\\

\hspace{-1cm}Z powyøszego opisu wynika, øe bÍdziemy potrzebowaÊ $n=5$ wspÛ≥rzÍdnych $x$ oraz $m=5$ wspÛ≥rzÍdnych $y$.
Podzia≥ przedzia≥Ûw ca≥kowania przyjmujπc, øe $h_x=\frac{\frac{4}{8}-0}{4}=\frac{4}{32}=\frac{1}{8}$ oraz $h_y=\frac{1-\frac{4}{8}}{4}=\frac{4}{32}=\frac{1}{8}$ prezentuje siÍ nastÍpujπco:
$$x_0=0,\, x_1=\frac{1}{8},\, x_2=\frac{2}{8},\, x_3=\frac{3}{8},\, x_4=\frac{4}{8},$$
$$y_0=\frac{4}{8},\, y_1=\frac{5}{8},\, y_2=\frac{6}{8},\, y_3=\frac{7}{8},\, y_4=1.$$ 
Do obliczeÒ wykorzystamy wzÛr rozpisany na podstawie (\ref{MacierzWspolczynnikowSimpson2}):
$$\int\limits_{0}^{\frac{1}{2}}\int\limits_{\frac{1}{2}}^1 \frac{x+y}{x^2+y^2}dydx\approx
\frac{h_xh_y}{9} \left(f(x_0,y_0)+4f(x_1,y_0)+2f(x_2,y_0)+4f(x_3,y_0)+f(x_4,y_0)+\right.$$
$$4f(x_0,y_1)+16f(x_1,y_1)+8f(x_2,y_1)+16f(x_3,y_1)+4f(x_4,y_1)+$$
$$ 2f(x_0,y_2)+8f(x_1,y_2)+4f(x_2,y_2)+8f(x_3,y_2)+2(x_4,y_2)+$$
$$4f(x_0,y_3)+16f(x_1,y_3)+8f(x_2,y_3)+16f(x_3,y_3)+4f(x_4,y_3)+$$
$$\left.f(x_0,y_4)+4f(x_1,y_4)+2f(x_2,y_4)+4f(x_3,y_4)+f(x_4,y_4)\right)=$$
$$=\frac{\frac{1}{8}\frac{1}{8}}{9}\left( \frac{\frac{4}{8}}{\left(\frac{4}{8}\right)^2} + 4\cdot \frac{\frac{5}{8}}{\left(\frac{1}{8}\right)^2+\left(\frac{4}{8}\right)^2} + 2 \cdot \frac{\frac{6}{8}}{\left(\frac{2}{8}\right)^2+\left(\frac{4}{8}\right)^2} + 4 \cdot \frac{\frac{7}{8}}{\left(\frac{3}{8}\right)^2+\left(\frac{4}{8}\right)^2} +\frac{1}{\left(\frac{4}{8}\right)^2+\left(\frac{4}{8}\right)^2} +  \right.$$
$$4\cdot\frac{ \frac{5}{8}}{\left(\frac{5}{8}\right)^2} + 16\cdot \frac{\frac{6}{8}}{\left(\frac{1}{8}\right)^2+\left(\frac{5}{8}\right)^2} + 8 \cdot \frac{\frac{7}{8}}{\left(\frac{2}{8}\right)^2+\left(\frac{5}{8}\right)^2} + 16 \cdot \frac{1}{\left(\frac{3}{8}\right)^2+\left(\frac{5}{8}\right)^2} + 4\cdot\frac{\frac{9}{8}}{\left(\frac{4}{8}\right)^2+\left(\frac{5}{8}\right)^2} +$$
$$2\cdot\frac{ \frac{6}{8}}{\left(\frac{6}{8}\right)^2} + 8\cdot \frac{\frac{7}{8}}{\left(\frac{1}{8}\right)^2+\left(\frac{6}{8}\right)^2} + 4 \cdot \frac{1}{\left(\frac{2}{8}\right)^2+\left(\frac{6}{8}\right)^2} + 8 \cdot \frac{\frac{9}{8}}{\left(\frac{3}{8}\right)^2+\left(\frac{6}{8}\right)^2} + 2\cdot\frac{\frac{10}{8}}{\left(\frac{4}{8}\right)^2+\left(\frac{6}{8}\right)^2} +$$
$$4\cdot\frac{ \frac{7}{8}}{\left(\frac{7}{8}\right)^2} + 16\cdot \frac{1}{\left(\frac{1}{8}\right)^2+\left(\frac{7}{8}\right)^2} + 8 \cdot \frac{\frac{9}{8}}{\left(\frac{2}{8}\right)^2+\left(\frac{7}{8}\right)^2} + 16 \cdot \frac{\frac{10}{8}}{\left(\frac{3}{8}\right)^2+\left(\frac{7}{8}\right)^2} + 4\cdot\frac{\frac{11}{8}}{\left(\frac{4}{8}\right)^2+\left(\frac{7}{8}\right)^2} +$$
$$\left.1 + 4\cdot \frac{\frac{9}{8}}{\left(\frac{1}{8}\right)^2+\left(1\right)^2} + 2 \cdot \frac{\frac{10}{8}}{\left(\frac{2}{8}\right)^2+\left(1\right)^2} + 4 \cdot \frac{\frac{11}{8}}{\left(\frac{3}{8}\right)^2+\left(1\right)^2} +\frac{\frac{12}{8}}{\left(\frac{4}{8}\right)^2+\left(1\right)^2} \right) \approx$$
$$\approx\frac{1}{576}\cdot(27.17176470588235 + 88.52877470325647 + 37.05169785169785 + $$
$$+ 63.40370323235645 + 13.80562821545899)\approx 0.399238834563632$$

W zaokrπgleniu wartoúÊ dok≥adna rozwiπzywanej ca≥ki, otrzymana przy wykorzystaniu kalkulatora naukowego to: $\int\limits_{0}^{\frac{1}{2}}\int\limits_{\frac{1}{2}}^1 \frac{x+y}{x^2+y^2}dydx \approx 0.399181467986060$.

Analizujπc wielkoúÊ b≥Ídu wzglÍdnego (\textbf{BW}), ktÛrym jest obciπøony wynik, zauwaøamy øe nie jest znaczπcy i wynosi jedynie $0.014\%$. Wynika to z poniøszych rachunkÛw: 
\begin{center}
$BW = \frac{|0.399181467986 - 0.399238834563632|}{0.399181467986} \cdot 100\% \approx 0.01437\%\approx 0.014\% $ \\
\end{center}
%W tym momencie uwidacznia siÍ zdecydowanie wiÍksza dok≥adnoúÊ \textit{uogÛlnionego wzoru Simpsona} w zestawieniu go z \textit{uogÛlnionym wzorem TrapezÛw}. 
Dla \textit{wzoru trapezÛw }wielkoúÊ BW (dla takiej samej ca≥ki) przy wykonanych dwÛch podzia≥ach przedzia≥u ca≥kowania oscylowa≥a w granicach $0,2\%$, wiÍc by≥a ona niemal 15 krotnie wiÍksza!
\end{ex}
Algorytm \textit{Simpsona} (\ref{SumaObjetosciDlaCalegoObszaruSimpson2D}) pomimo tego, øe na pierwszy rzut oka wydaje siÍ byÊ skuteczniejszy niø  wspomniany \textit{wzÛr TrapezÛw} (\ref{RownoscUogWzoruTrapezow2IWzoruZObjetosciami}), to jest rÛwnieø duøo bardziej skomplikowany jeøeli chodzi o z≥oøonoúÊ rachunkÛw jakie naleøy wykonaÊ. Kaøde zwiÍkszenie liczby wÍz≥Ûw powoduje bardzo szybki rozrost iloúci wartoúci funkcji do wyznaczenia. W zwiπzku z tym, by kontynuowaÊ rozwaøania zaprezentujmy stworzonπ procedurÍ automatyzujπcπ obliczanie wartoúci ca≥ek podwÛjnych w prostokπcie \textit{uogÛlnionym wzorem Simpsona}.
\begin{proc}(Wyznaczanie przybliøonych wartoúci ca≥ek podwÛjnych po obszarach normalnych przy uøyciu \textit{uogÛlnionego wzoru Simpsona})\label{MAPLE_Simpson2ObszarNormalnyWartoscCalki}
\begin{small}
\begin{verbatim}
> Simpson2 := proc(a, b, c, d, N, M) 
  local h, k, i, j, n, m, p, q, x, y, z, S2, WynikS2; 
  if ((((ceil(N)>N) or (floor(N)<N)) or (mod(N,2) = 1 and N>0) or N <= 0)
   or (((ceil(M)>M) or (floor(M)<M)) or (mod(M,2) = 1 and M>0) or M <= 0)) 
  then 
    ERROR('Ostatnie dwa parametry musza byc liczba naturalna postaci \2k'); 

  else 
    n := (1/2)*N; 
    m := (1/2)*M; 
    h := (b-a)/N; 
    k := (d-c)/M; 

   for i from 0 to N 
      do x := i -> a+i*h od; 

   for j from 0 to M 
      do y := j -> c+j*k od; 

   for i from 0 to N 
      do for j from 0 to M 
           do z :=(i,j) -> f(x(i),y(j)) od;
      od; 

  S2 := (1/9)*h*k*(sum(sum(z(2*p,2*q)+4*z(2*p+1,2*q)+z(2*p+2,2*q)
        +4*z(2*p,2*q+1)+16*z(2*p+1,2*q+1)+4*z(2*p+2,2*q+1)
        +z(2*p,2*q+2)+4*z(2*p+1,2*q+2)+z(2*p+2,2*q+2)
        , p = 0 .. n-1), q = 0 .. m-1)); 

  WynikS2 := evalf(S2) fi; 
  end;
\end{verbatim}
\end{small}
\end{proc}  

Pierwsza linia powyøszego kodu jest deklaracjπ nazwy procedury oraz jej parametrÛw wejúciowych, przy czym:\\
a, b -  dolna i gÛrna granica ca≥kowania wzglÍdem zmiennej $x$,\\
c, d -  dolna i gÛrna granica ca≥kowania wzglÍdem zmiennej $y$,\\
N - liczba podpodprzedzia≥Ûw na jakie zostanie podzielony ca≥y przedzia≥ ca≥kowania $[a,b]$,\\
M - liczba podpodprzedzia≥Ûw na jakie zostanie podzielony ca≥y przedzia≥ ca≥kowania $[c,d]$.\\
Kolejno wymienione sπ wszystkie zmienne lokalne, jakie bÍdπ wykorzystane w obliczeniach wykonywanych wewnπtrz algorytmu. Pojawiajπca siÍ nastÍpnie instrukcja warunkowa \textit{if-else} decyduje o tym, czy parametry wywo≥ania zosta≥y podane prawid≥owo. Jeøeli $N$ lub $M$ nie jest liczbπ naturalnπ parzystπ to zwracany jest stosowny komunikat o b≥Ídzie. W przeciwnym przypadku rozpoczyna siÍ wykonanie w≥aúciwej czÍúci algorytmu, w sk≥ad ktÛrego wchodzi okreúlenie iloúci podprzedzia≥Ûw $n$, $m$ (kaødy podprzedzia≥ z≥oøony jest z dwÛch podpodprzedzia≥Ûw) na ktÛre podzielono przedzia≥y ca≥kowania po zmiennej $x$ i $y$. Dalej na podstawie (\ref{WezlyNaObszarzeProstokatnymSimpson2}) wyznaczane sπ wielkoúci krokÛw $h$ (dla $x$) i $k$ (dla $y$) pomiÍdzy kolejnymi wÍz≥ami definiujπcymi kraÒce owych podpodprzedzia≥Ûw. Pozyskane dane zostajπ natychmiast wykorzystywane przez pÍtle \textit{for} do obliczenia wspÛ≥rzÍdnych wÍz≥Ûw $x_i$ oraz $y_j$. Blok z dwoma zagnieødøonymi pÍtlami \textit{for} s≥uøy wyliczaniu wartoúci funkcji $z(i,j)=f(x_i,y_j)$ w okreúlonych (w poprzednich dwÛch krokach) punktach wÍz≥owych. Przedostatni krok jest implementacjπ wzoru (\ref{SumaObjetosciDlaCalegoObszaruSimpson2D}), co czyni go kluczowym dla ca≥ego algorytmu. Ostatecznie wynik procedury jest zwracany w uproszczonej i czytelnej postaci jako wartoúÊ \textit{WynikS2}.

Wiedzπc juø na jakiej zasadzie dzia≥a procedura \textit{Simpson2} - uøyjmy jej do przeprowadzenia badaÒ nad dok≥adnoúciπ pozyskanych dziÍki niej przybliøeÒ wynikÛw oznaczonych ca≥ek podwÛjnych w obszarze normalnym wzglÍdem $x$ i $y$. Rezultaty porÛwnamy z tymi, otrzymanymi przez \textbf{ProcedurÍ \ref{MAPLE_Trapez2ObszarNormalnyWartoscCalki}} (\textit{Trapez2}). Przeliczmy zatem nastÍpujπce przyk≥ady: 
\begin{itemize}
\item[a)] $\int\limits_0^\frac{1}{2}\int\limits_\frac{1}{2}^1 \frac{x+y}{x^2+y^2} dydx$
\item[b)] $\int\limits_0^1\int\limits_1^2 e^\frac{x^2}{y^3} dydx$
\end{itemize}
Tak jak w  podrozdziale poprzednim wyniki podamy w formie tabel. Niech $N$ oznacza liczbÍ podprzedzia≥Ûw na ktÛre podzielono przedzia≥ ca≥kowania po zmiennej $x$, $M$ po zmiennej $y$, $W_{Simpson2}$ to wynik \textit{Simpson2} dla rosnπcych wartoúci $N$ i $M$. Niech \textit{$BBS2_{N,M}$} bÍdzie b≥Ídem bezwzglÍdnym przybliøenia wartoúci ca≥ki podwÛjnej procedurπ \textit{Simpson2} dla pewnych parametrÛw $N$ i $M$. Dodatkowo \textit{$BWS2_{N,M}$} to wielkoúÊ b≥Ídu wzglÍdnego jakim jest obciπøony ten sam wynik wykonania \textit{Simpson2}, co w przypadku wyliczania \textit{$BBS2_{N,M}$}.\\

\hspace{-1cm}WartoúÊ ca≥ki z przyk≥adu a) jest w zaokrπgleniu rÛwna $0.399181467986$, wiÍc:
\begin{table}[h!]
\hspace{-1cm} \caption{Pomiary dok≥adnoúci przybliøenia wartoúci ca≥ki a) procedurπ \textit{Simpson2}}
\hspace{-4.6cm}{\footnotesize èrÛd≥o: Opracowanie w≥asne\\}
\centering
 \begin{tabular}{|c|c|c|c|c|} 
 \hline
 $\mathbf{N}$ &$\mathbf{M}$ & $\mathbf{W_{Simpson2}}$ & $\mathbf{BBS2_{N,M}}$ &$\mathbf{BWS2_{N,M}}$ \\ %[0.5ex] 
 \hline \hline
 2&4 &0.399628737181  &0.000447269195  &0.112046583038 \%  \\  
  \hline 
 4&4 &0.399238834564  &0.000057366578  &0.014371052416 \% \\ 
  \hline
 8&4 &0.399209961856  &0.000028493870     &0.007138074356 \% \\ 
  \hline 
 16&20 &0.399181624022  &0.000000156036   &0.000039088989 \% \\ 
  \hline 
 30&20 &0.399181522060  &0.000000054074   &0.000013546220 \% \\ 
  \hline 
 60&20 &0.399181513672  &0.000000045686   &0.000011444920 \% \\ 
  \hline 
 90&50 &0.399181469254  &0.000000001268   &0.000000317650 \% \\ 
  \hline
 120&50 &0.399181469179  &0.000000001193  &0.000000298862 \% \\  
  \hline 
 150&50 &0.399181469158  &0.000000000117  &0.000000293600 \% \\ 
  \hline 
 180&100 &0.399181468065  &0.000000000079 &0.000000019790 \% \\ 
  \hline
 200&100 &0.399181468063  &0.000000000077 &0.000000019289 \% \\ 
  \hline 
 230&100 &0.399181468061  &0.000000000075 &0.000000018788 \% \\  
  \hline 
 260&200 &0.399181467992  &0.0000000000006 &0.000000001503 \% \\ 
   \hline 
 300&200 &0.399181467991  &0.0000000000005 &0.000000001253 \% \\ 
  \hline               
 400&200 &0.399181467991  &0.0000000000005  &0.000000001253  \%  \\%[0.5ex] 
 \hline 
 \end{tabular}\\ \hfill
 \label{WynikiZProcedurySimpson2a}
\end{table}
\\ 

\hspace{-1cm}Ca≥ka z podpunktu b) wynosi dok≥adnie $1.14782135872$ , zatem:. 
\begin{table}[h!]
 \caption{Pomiary dok≥adnoúci przybliøenia wartoúci ca≥ki b) procedurπ \textit{Simpson2}}
\hspace{-4.6cm}{\footnotesize èrÛd≥o: Opracowanie w≥asne\\}
\centering
 \begin{tabular}{|c|c|c|c|c|} 
 \hline
 $\mathbf{N}$ &$\mathbf{M}$ & $\mathbf{W_{Simpson2}}$ & $\mathbf{BBS2_{N,M}}$ &$\mathbf{BWS2_{N,M}}$ \\ %[0.5ex] 
  \hline \hline
 2&4 &1.15087844676    &0.00305708804   &0.266338312733 \%  \\  
  \hline 
 4&4 &1.14909546116    &0.00127410244   &0.111001806189 \% \\ 
  \hline
 8&4 &1.14895802395    &0.00113666523   &0.099028060539 \% \\ 
  \hline 
 16&20 &1.14782496457  &0.00000360585   &0.000314147317 \% \\ 
  \hline 
 30&20 &1.14782444884  &0.00000309012   &0.000269216109 \% \\ 
  \hline 
 60&20 &1.14782440610  &0.00000304738   &0.000265492533 \% \\ 
  \hline 
 90&50 &1.14782144016  &0.00000008144   &0.000007095181 \% \\ 
  \hline
 120&50 &1.14782143971 &0.00000008099   &0.000007055976 \% \\ 
  \hline 
 150&50 &1.14782143962  &0.00000008090  &0.000007048135 \% \\ 
  \hline 
 180&100 &1.14782136425  &0.00000000554  &0.000000481782 \% \\ 
  \hline
 200&100 &1.14782136416 &0.00000000544  &0.000000473941 \% \\ 
  \hline 
 230&100 &1.14782136423  &0.00000000551  &0.000000480039 \% \\  
  \hline 
 260&200 &1.14782135945  &0.00000000126  &0.000000063598 \% \\ 
   \hline 
 300&200 &1.14782135952  &0.00000000081  &0.000000070568 \% \\ 
  \hline               
 400&200 &1.14782135935  &0.00000000063 & 0.000000054886 \%  \\%[0.5ex] 
 \hline 
 \end{tabular}\\ \hfill
\label{WynikiZProcedurySimpson2b}
\end{table}


Dokonujπc przeglπdu i analizy wartoúci z Tablicy \ref{WynikiZProcedurySimpson2a} i Tablicy \ref{WynikiZProcedurySimpson2b} pierwsze, co powinno rzuciÊ siÍ nam w oczy, to wyjπtkowa dok≥adnoúÊ otrzymanych wynikÛw. WielkoúÊ b≥Ídu bezwzglÍdnego juø dla pierwszego wywo≥ania procedury w obydwu przyk≥adach nie przekroczy≥a $0.0031$ - jest to bardzo dobry rezultat. Dodatkowo po kaødym zwiÍkszeniu parametrÛw $N$ lub $M$ widoczna jest stanowcza tendencja spadkowa \textbf{$BBS2_{N,M}$} jak i \textbf{$BWS2_{N,M}$}. Dla koÒcowych pomiarÛw moøna powiedzieÊ, øe wynik jest obciπøony znikomym b≥Ídem przybliøenia, poniewaø jego wielkoúÊ jest bliska $0$ dla obydwu przyk≥adÛw. Interesujπce jest to, øe pomiÍdzy b≥Ídami, ktÛrymi obciπøone sπ wyniki otrzymane \textit{uogÛlnionym wzorem trapezÛw} a \textit{uogÛlnionym wzorem Simpsona} jest úrednio dwa rzÍdy wielkoúci rÛønicy (na korzyúÊ wzoru \textit{Simpsona}). Fakt ten sprawia, øe moøe on zostaÊ uznany za dok≥adniejsze i zarazem bardziej efektywne narzÍdzie przybliøajπce wartoúci ca≥ek podwÛjnych na obszarze prostokπtnym.









%\section{WzÛr 'prostokπtÛw'}