\chapter{Kwadratury Newtona-Cotesa dla ca³ek podwójnych}
W ca³ym poprzednim rozdziale skupialiœmy siê na metodach ca³kowania numerycznego. Odnosi³y siê one jednak tylko do funkcji jednej zmiennej - zatem ca³kowanie odbywa³o siê na pewnym przedziale domkniêtym. Teraz chcemy poszerzyæ nasz¹ wiedzê i przejœæ o jeden krok dalej. Nasze rozwa¿ania zostan¹ skierowane ponownie na te same, co poprzednio metody ca³kowania numerycznego. Znacz¹ca ró¿nica polega³a bêdzie na tym, ¿e zajmiemy siê ca³kowaniem funkcji dwóch zmiennych. Wszystkie nasze dzia³ania maj¹ na celu wy³onienie najdok³adniejszej metody wyznaczania wartoœci ca³ek podwójnych przy pomocy prezentowanych algorytmów.  W badaniach wyró¿nimy dwa typy obszarów ca³kowania, bêd¹ to:
\begin{itemize}
\item[a)] Obszar normalny ze wzglêdu na zmienn¹ $x$ i $y$
\item[b)] Obszar normalny tylko ze wzglêdu na zmienn¹ $x$
\end{itemize}

W celu kontynuacji rozwa¿añ nale¿y przypomnieæ niezbêdn¹ dla nas definicjê normalnoœci obszaru:
\begin{definition}(Obszar normalny)\\
O obszarze normalnym w przestrzeni kartezjañskiej $\re ^2$ 
\begin{itemize}
\item[a)]wzglêdem osi $OX$ (tj. wzglêdem $x$) mówimy, gdy podzbiór p³aszczyzny kartezjañskiej ograniczony jest przez wykresy pewnych dwóch funkcji ci¹g³ych $u(x)$ i $v(x)$ oraz dwie proste równoleg³e do osi $OY$.    
\item[b)]wzglêdem osi $OY$ (tj. wzglêdem $y$) mówimy, gdy podzbiór p³aszczyzny kartezjañskiej jest wyznaczany poprzez wykresy dwóch ró¿nych funkcji ci¹g³ych $l(y)$ i $k(y)$ oraz dwie proste, które s¹ równoleg³e do osi $OX$.
\item[c)]ze wzglêdu na zmienne $x$ i $y$ mówimy, gdy podzbiór p³aszczyzny kartezjañskiej jest ograniczony przez dwie proste równoleg³e do osi $OX$ oraz dwie proste równoleg³e do $OY$ 

\end{itemize}

\section{Wzór trapezów}
W podrozdziale \ref{Podrozdzial_WzorTrapezow} wyprowadziliœmy ju¿ wzór trapezów (\ref{wzorTrapezowBrakPodzialu}) i uogólniony wzór trapezów (\ref{OgolnyWzorTrapezow}). Najbardziej interesuje nas drugi ze wspomnianych. Istnieje mo¿liwoœæ rozszerzenia go na przypadek ogólny dotycz¹cy funkcji dwóch zmiennych. Rozpocznijmy od wariantu, dla którego obszar ca³kowania jest obszarem normalnym ze wzglêdu na dwie zmienne.  


Niech ca³kowanie odbywa siê na obszarze $\Omega=\{a\leq x\leq b ; c\leq y \leq d \}$. 
Przedzia³ $[a,b]$ zostanie podzielony na $\frac{N_x}{2}=n$ podprzedzia³ów postaci $[x_i,x_{i+1}]$ ($i=0,1,\ldots, n-1$). Podobnie bêdzie dla $[c,d]$, podzielimy go na $\frac{N_y}{2}=m$ podprzedzia³ów $[y_j,y_{j+1}]$ ($j=0,1,\ldots, m-1$). \mbox{W zwi¹zku} z tym zajdzie nastêpuj¹ca prawid³owoœæ:

\begin{center}
$a=x_0\leq x_1\leq x_2\ldots\leq x_n=b$ \,\,\,\,($i=0,1,\ldots ,n$) \\ 
$c=y_0\leq y_1\leq y_2\ldots\leq y_m=d$ \,\,\,\,($j=0,1,\ldots ,m$)\\
\end{center}
Postaæ punktów $x_i$, $y_j$ nale¿¹cych do tych przedzia³ów, jak równie¿ kroków $h_x$ i $h_y$ pomiêdzy kolejnymi wartoœciami wêz³ów to:
\begin{equation}\label{WezlyNaObszarzeProstokatnymTrapez2}
\begin{array}{cc}
x_i=x_0+ih_x,\,\,\,\, h_x=\frac{b-a}{n}\\
y_j=y_0+jh_y, \,\,\,\,h_y=\frac{d-c}{m}\\
\end{array}
\end{equation}

Zapiszmy wzór (\ref{OgolnyWzorTrapezow}) w nieco innej postaci, która bêdzie dla nas bardziej porêczna, tzn.:
\begin{equation}\label{UogolnionyWzorTrapezow1Przeksztalcony}
\int\limits_a^b f(x) dx \approx \frac{h}{2}\sum\limits_{i=0}^{n-1}[f(x_i)+f(x_{i+1})]=\frac{h}{2}\left[f(x_0)+f(x_n)+2\sum\limits_{i=1}^{n-1} f(x_i) \right].
\end{equation} 
Kolejno weŸmy pewn¹ oznaczon¹ ca³kê podwójn¹ postaci:
\begin{equation}\label{CalkaPodwojna}
I_{T2}=\int\limits_a^b\int\limits_c^d f(x,y)dydx=\int\limits_a^b g(x)dx\,\, ,
\end{equation} 
\end{definition}
\begin{flushleft}
przy czym ( rozbudowuj¹c (\ref{UogolnionyWzorTrapezow1Przeksztalcony}) o dodatkow¹ zmienn¹\,)
\end{flushleft}
\begin{equation}\label{Wyjasnienie_g(x)_metodaTrapezow2}
g(x)=\int\limits_c^d f(x,y)dy\approx\frac{h_y}{2}\left[ f(x,y_0)+f(x,y_m)+2\sum\limits_{j=1}^{m-1}f(x,y_j)\right].
\end{equation}   
Podstawmy opisan¹ przez równanie (\ref{Wyjasnienie_g(x)_metodaTrapezow2}) postaæ $g(x)$ do (\ref{CalkaPodwojna}). Skutkuje to tym, ¿e:
\begin{equation}\label{SprowadzenieCalkiPodwDoPojedynczejZSumaTrapez2}
I_{T2}=\int\limits_a^b\int\limits_c^d f(x,y)dydx\approx\int\limits_a^b \frac{h_y}{2}\left[ f(x,y_0)+f(x,y_m)+2\sum\limits_{j=1}^{m-1}f(x,y_j)\right] dx  \,.
\end{equation}
W celu wyeliminowania potrzeby ca³kowania w (\ref{SprowadzenieCalkiPodwDoPojedynczejZSumaTrapez2}) ponownie zostaje zastosowana metoda trapezów z równania (\ref{UogolnionyWzorTrapezow1Przeksztalcony}) (rozszerzona w podobny sposób jak w (\ref{Wyjasnienie_g(x)_metodaTrapezow2})). Tym razem traktujemy $x$ jako zmienn¹, natomiast ca³e wyra¿enie podca³kowe jako jedn¹ funkcjê. Sprowadza to nasz problem do nastêpuj¹cego przypadku:
\begin{equation}\label{CalkaPodwojnaJakoSumaTrapez2}
\begin{array}{cc}
I_{T2}\approx \frac{h_x}{2} \left\lbrace \frac{h_y}{2}\left[ f(x_0,y_0)+f(x_0,y_m)+2\sum\limits_{j=1}^{m-1}f(x_0,y_j)\right] \right.\\
+ \frac{h_y}{2}\left[ f(x_n,y_0)+f(x_n,y_m)+2\sum\limits_{j=1}^{m-1}f(x_n,y_j)\right] \\
+ \left. 2\sum\limits_{i=1}^{n-1}\frac{h_y}{2}\left[ f(x_i,y_0)+f(x_i,y_m)+2\sum\limits_{j=1}^{m-1}f(x_i,y_j)\right]
\right\rbrace
\end{array}
\end{equation}
Po uproszczeniu ostateczn¹ form¹ (\ref{CalkaPodwojnaJakoSumaTrapez2}) jest:
\begin{equation}\label{UogolnionyWzorTrapezow2_obszarNormalny}
\begin{array}{cc}
I_{T2}\approx \frac{h_x h_y}{4}\left\lbrace f(x_0,y_0)+f(x_0,y_m)+f(x_n,y_0)+f(x_n,y_m)
+ 4\sum\limits_{i=1}^{n-1}\sum\limits_{j=1}^{m-1}f(x_i,y_j)\right.\\
\left. +2\sum\limits_{j=1}^{m-1}\left[f(x_0,y_j)+f(x_n,y_j)\right]
+ 2\sum\limits_{i=1}^{n-1}\left[f(x_i,y_0)+f(x_i,y_m)\right]\right\rbrace
\end{array}
\end{equation}

Interesuj¹cym faktem jest to, ¿e wspó³czynniki wagowe kwadratury opisanej powy¿szym wzorem rozk³adaj¹ siê wed³ug pewnego schematu. Co oznacza, ¿e je¿eli rozpisalibyœmy (\ref{UogolnionyWzorTrapezow2_obszarNormalny}) tak, by uwzglêdniæ w nim wszystkie punkty wêz³owe postaci $(x_i,y_j)$ ( $i=0,1,\ldots,n$,\, \mbox{$j=0,1,\ldots,m$} ) nale¿¹ce do pewnego obszaru prostok¹tnego i spe³niaj¹ce (\ref{WezlyNaObszarzeProstokatnymTrapez2}), to odpowiednio wartoœci przy kolejnych $f(x_i,y_j)$ ( $i=0,1,\ldots,n\,\,\,,\,\,\,\, j=0,1,\ldots,m$ ) rozk³ada³yby siê nastêpuj¹co:
\begin{equation}\label{MacierzWspolczynnikowTrapez2}
\begin{array}{ccccccccc}
1 & 2 & 2 & 2 &\cdots & 2& 2& 2& 1\\
2 & 4 & 4 & 4 &\cdots & 4& 4& 4& 2\\
2 & 4 & 4 & 4 &\cdots & 4& 4& 4& 2\\
\vdots &\vdots &\vdots &\vdots & \ddots &\vdots &\vdots &\vdots &\vdots \\
2 & 4 & 4 & 4 &\cdots & 4& 4& 4& 2\\
1 & 2 & 2 & 2 &\cdots & 2& 2& 2& 1\\
\end{array}
\end{equation}
Powy¿sza macierz znacz¹co upraszcza i przyspiesza rozpisywanie \textbf{uogólnionego wzoru trapezów dla ca³ek podwójnych po obszarach normalnych}. Dla przypadku uogólnionego wzoru trapezów dla ca³ki pojedynczej schemat ten ogranicza³ siê jedynie do pierwszego wiersza (numeracja $i$ - od lewej do prawej, $j$ - od góry do do³u).

Obliczanie wartoœci ca³ki podwójnej metod¹ trapezów mo¿emy sprowadziæ równie¿ do  sumowania objêtoœci pewnych bry³ trapezoidalnych. Innymi s³owy - rozwa¿my podzia³ obszaru ca³kowania $\Omega = [a,b] \times [c,d]$ na $n\cdot m$ podobszarów, co prezentuje rysunek \ref{R4} zamieszczony poni¿ej:

\begin{figure}[H]
		\begin{center}
		\includegraphics[scale=0.6]{R4.eps}
		\end{center}
	   \caption{\cite{klucz10} Metoda trapezów dla ca³ek podwójnych - podzia³ obszaru ca³kowania na podobszary }
\label{R4}
\end{figure}
\begin{flushleft}
Jak widaæ, ka¿dy z podobszarów jest wyznaczany przez cztery wierzcho³ki $(x_i,y_j)$ (definicja $x_i$, $y_j$ taka jak w (\ref{WezlyNaObszarzeProstokatnymTrapez2})). Do obliczenia objêtoœci ka¿dej z takich bry³ trapezoidalnych potrzebne s¹ nam pola podstawy ( ju¿ je znamy - s¹ one takie same dla ka¿dego podobszaru i wynosz¹ $h_xh_y$), oraz odpowiadaj¹ce dla nich wysokoœci. Te ostatnie okreœlimy jako œrednia arytmetyczna wartoœci funkcji $f(x,y)$ w czterech wierzcho³kach definiuj¹cych ka¿dy z podobszarów ca³kowania. Ostatecznie objêtoœæ ka¿dej bry³y definiowa³ bêdzie nastêpuj¹cy wzór \cite{klucz10}:
\end{flushleft}
\begin{equation}\label{ObjetoscDowolnegoTrapezoiduMetodaTrapezow2}
V_{i,j}=h_xh_y\left[\frac{f(x_{i},y_{j})+f(x_{i+1},y_{j})+f(x_{i},y_{j+1})+f(x_{i+1},y_{j+1})}{4}\right],
\end{equation}
przy czym $h_x$, $h_y$ opisane s¹ w (\ref{WezlyNaObszarzeProstokatnymTrapez2}).\\ Rozszerzaj¹c równanie (\ref{ObjetoscDowolnegoTrapezoiduMetodaTrapezow2}), charakteryzuj¹ce pojedyncz¹ objêtoœæ bry³y na ca³y obszar ca³kowania dobrnêlibyœmy do równoœci postaci  (\ref{UogolnionyWzorTrapezow2_obszarNormalny}). Analizuj¹c powy¿sze zapiski wnioskujemy i¿ zachodzi nastêpuj¹ca prawid³owoœæ: 
\begin{equation}\label{RownoscUogWzoruTrapezow2IWzoruZObjetosciami}
I_{T2V} = I_{T2}\approx \sum\limits_{i=0}^{n-1} \sum\limits_{j=0}^{m-1} h_xh_y\left[\frac{f(x_{i},y_{j})+f(x_{i+1},y_{j})+f(x_{i},y_{j+1})+f(x_{i+1},y_{j+1})}{4}\right]
\end{equation}
Porównuj¹c macierz (\ref{MacierzWspolczynnikowTrapez2}) z rysunkiem \ref{R4} zauwa¿ymy, ¿e elementy macierzy odzwierciedlaj¹ iloœæ podobszarów, na styku których umiejscowiony zosta³ dany wêze³. Nie jest to oczywiœcie kwesti¹ przypadku. Oznacza to, ilu krotnie dany punkt wêz³owy zostaje uwzglêdniony podczas sumowania (\ref{RownoscUogWzoruTrapezow2IWzoruZObjetosciami}).

Wzór (\ref{UogolnionyWzorTrapezow2_obszarNormalny}) podobnie jak dla przypadku ca³ki pojedynczej mo¿na równie¿ otrzymaæ wykorzystuj¹c wielomiany \textit{Lagrange'a $L_{1,1}(x,y)$}. Podamy jedynie zarys przekszta³ceñ, które doprowadzi³yby nas do wyniku: 
\begin{equation}\label{WzorTrapezowWielomianemL11}
\begin{array}{cc}
\int\limits_a^b \int\limits_c^d f(x,y) dydx\approx \int\limits_a^b \int\limits_c^d L_{1,1}(x,y) dydx = 
\sum\limits_{i=0}^{n-1} \sum\limits_{j=0}^{m-1}\int\limits_{x_i}^{x_{i+1}} \int\limits_{y_i}^{y_{i+1}} L_{1,1}(x,y) dydx =\\
\frac{h_xh_y}{4} \sum\limits_{i=0}^{n-1} \sum\limits_{j=0}^{m-1} \left[f(x_{i},y_{j})+f(x_{i+1},y_{j})+f(x_{i},y_{j+1})+f(x_{i+1},y_{j+1})\right]
\end{array}
\end{equation}
Mogliœmy wykonaæ ostatnie przejœcie poniewa¿ wynik dla ka¿dej ca³ki $\int\limits_{x_i}^{x_{i+1}} \int\limits_{y_i}^{y_{i+1}} L_{1,1}(x,y) dydx$ jest takiej samej postaci, zmienia siê jedynie numer wêz³a branego pod uwagê. Dla przyk³adu:
\begin{equation}
\begin{array}{cc}
\int\limits_{x_0}^{x_{1}} \int\limits_{y_0}^{y_{1}} L_{1,1}(x,y) dydx
 =
 \int\limits_{x_0}^{x_{1}} \int\limits_{y_0}^{y_{1}}\left( f(x_0,y_0)\left(\frac{x-x_1}{x_0-x_1}\frac{y-y_1}{y_0-y_1} \right)
 +f(x_0,y_1)\left(\frac{x-x_1}{x_0-x_1}\frac{y-y_0}{y_1-y_0} \right)\right.\\
\left. +f(x_1,y_0)\left(\frac{x-x_0}{x_1-x_0}\frac{y-y_1}{y_0-y_1} \right)
 +f(x_1,y_1)\left(\frac{x-x_0}{x_1-x_0}\frac{y-y_0}{y_1-y_0} \right)
 \right) dydx= \ldots =\\ 
 \frac{h_xh_y}{4}\left[f(x_{0},y_{0})+f(x_{1},y_{0})+f(x_{0},y_{1})+f(x_{1},y_{1})\right]
\end{array}
\end{equation}
























     
     

\section{Wzór Simpsona}
\section{Wzór 'prostok¹tów'}