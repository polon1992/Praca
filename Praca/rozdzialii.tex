
\chapter{Kwadratury Newtona-Cotesa dla ca³ki pojedynczej}


Niech $f(x)$ bêdzie funkcj¹ zdefiniowan¹ na przedziale $[a,b]$ o wartoœciach rzeczywistych tzn. $f: [a,b]\rightarrow \re$. 
Rozwa¿my pewn¹ ca³kê 
\begin{equation}\label{I(f)=Calkaf(x)}
I(f)=\int\limits_a^b f(x) dx
\end{equation}

Funkcjê podca³kow¹ zawsze mo¿emy zast¹piæ inn¹ funkcj¹ tak¹, ¿e w miarê mo¿liwoœci poni¿sze przybli¿enie bêdzie prawdziwe:
\begin{equation}\label{ZastapienieFunkcjiFxfunkcjaGx}
\int\limits_a^b f(x) dx \approx \int\limits_a^b g(x) dx
\end{equation}

W praktyce czêsto spotkaæ mo¿emy siê z przypadkiem takim, ze do wyznaczenia przybli¿onych wartoœci $I(f)$  stosowane s¹ wzory nazywane kwadraturami. 
Owe kwadratury opieraj¹ siê jedynie na wartoœciach $f(x)$ w punktach wêz³owych i mog¹ niezbyt dok³adnie przybli¿aæ wynik tzn: 
\begin{equation}\label{WzorKwadratura}
\int\limits_a^b f(x) dx \approx \sum\limits_{i=0}^n a_if(x_i),\,\,\,\, x_i\in[a,b],
\end{equation}
przy czym wspó³czynniki $a_i$ s¹ niezale¿ne od $f(x)$ (nazywamy je wspó³czynnikami kwadratury), zaœ $x_i$ nosi miano wêz³ów kwadratury.

Naszym celem jest jednak to, by jak najbardziej zminimalizowaæ b³¹d pojawiaj¹cy siê podczas przybli¿ania wartoœci $I(f)$. W zwi¹zku z tym mo¿emy zastosowaæ zabieg zast¹pienia funkcji $f(x)$ w ca³ce $I(f)$ wielomianem interpoluj¹cym j¹. W tym celu wykorzystamy wielomian interpolacyjny \textit{Lagrange'a} (\ref{wielomianInterpolacyjnyLagrangea}). Po podstawieniu go do (\ref{WzorKwadratura}) otrzymamy:

\begin{equation}\label{SumaCalkowaLagrangeWkwadraturze}
\int\limits_a^b f(x) dx \approx \int\limits_a^b L_n(x) dx=
\sum\limits_{i=0}^n \alpha_i f(x_i) dx,
\end{equation}
gdzie 
\begin{equation}\label{wspolczynnikAi}
\alpha_i=\int\limits_a^b l_i(x),
\end{equation}
 natomiast 
 \begin{equation}\label{l_iDlaKwadraturN-C}
 l_i(x)=\prod\limits_{j=0, j\neq i}^n  \frac{x-x_j}{x_i-x_j} \,\,\,\,\,\,\, (i=0,1,\ldots,n).
 \end{equation}
W zwi¹zku z powy¿szym ca³kê (\ref{I(f)=Calkaf(x)}) mo¿emy wyraziæ w nastêpuj¹cy sposób:
\begin{equation}\label{PrzyblizenieCalkiSumaCalkowaZwielomianamiBazowymiLagrangea}
\int\limits_a^b f(x) dx \approx \sum\limits_{i=0}^n f(x_i)\int\limits_a^b l_i(x) dx
\end{equation}
Je¿eli w (\ref{PrzyblizenieCalkiSumaCalkowaZwielomianamiBazowymiLagrangea}) rozpatrzymy tylko wêz³y takie, ¿e $x_0=a$, $x_n=b$, a ka¿dy wêze³ poœredni le¿¹cy pomiêdzy $x_0$ a $x_n$ jest postaci $x_i=a+ih$ $(i=0,1,\ldots,n)$, $h=\frac{x_n-x_0}{n}$, to kwadraturê tak¹ nazwiemy kwadratur¹ \textbf{Newtona-Cotesa}. Skupimy siê na rozwa¿eniu trzech ró¿nych kwadratur tego typu, bêd¹ nimi: \textit{wzór trapezów}, \textit{wzór Simpsona} oraz \textit{wzór prostok¹tów}.


\section{Wzór trapezów}

%Zauwa¿my, ¿e przybli¿enie $\sum\limits_{i=0}^n f(x_i)\int\limits_a^b L_i(x) dx$ jest szczególnym przypadkiem sumy z równania (\ref{WzorKwadratura}), przy czym: 

%\begin{equation}\label{wspolczynnikAi}
%a_i=\int\limits_a^b L_i(x) dx
%\end{equation}


Do wyznaczenia wzoru trapezów bêdziemy wykorzystywaæ wielomian interpolacyjny \textit{Lagrange'a} rzêdu $n=1$ ($L_1(x)$) utworzony dla wêz³ów $a$ i $b$.
Zastosujmy w (\ref{l_iDlaKwadraturN-C}) nastêpuj¹ce podstawienie: $x=a+hs$. Wartoœci $a,h$ s¹ pewnymi sta³ymi, natomiast $s$ jest zmienn¹ niezale¿n¹.
$$l_i(x)=\prod\limits_{j=0, j\neq i}^n \frac{x-x_j}{x_i-x_j}=
\prod\limits_{j=0, j\neq i}^n \frac{a+hs-(a+jh)}{(a+ih)-(a+jh)}=
\prod\limits_{j=0, j\neq i}^n \frac{s-j}{i-j}$$
Otrzymujemy zatem:
\begin{equation}\label{WielomianLagrangeaPoPodstawieniuZaX}
l_i(x)=\prod\limits_{j=0, j\neq i}^n \frac{s-j}{i-j}=\psi_i(s)
\end{equation}
$\psi_i(s)$ to nasza nowa funkcja zmiennej $s$.


Ca³kê z równania (\ref{wspolczynnikAi}) obliczymy metod¹ ca³kowania przez podstawienie. Skorzystamy z przedstawionego przed chwil¹ podstawienia $x=a+hs$ oraz równania (\ref{WielomianLagrangeaPoPodstawieniuZaX})\\

$a_i=\int\limits_a^b l_i(x) dx=\left\{\begin{array}{ll}
x=a+hs\\
dx=h ds\\
b=a+hs \Rightarrow \frac{b-a}{h}=s\Rightarrow s=n\\
a=a+hs \Rightarrow 0=hs \Rightarrow s=0
\end{array}\right\}=h\int\limits_0^n \psi_i(s)ds
$\\

Chcemy wyliczyæ teraz wartoœci wspó³czynników kwadratury $a_0$ i $a_1$. Pamiêtamy o tym, ¿e  do obliczeñ wykorzystujemy postaæ wielomianu \textit{Lagrange'a} rzêdu $n=1$, zatem bêdziemy ca³kowali w granicach $[0,n]=[0,1]$
$$a_0=h\int\limits_0^1 \phi_0(s) ds=h\int\limits_0^1\frac{s-1}{0-1}ds=\int\limits_0^1(1-s)ds= h\left[s-\frac{s^2}{2}\right]_0^1=\frac{h}{2}$$
$$a_1=h\int\limits_0^1 \phi_1(s) ds=h\int\limits_0^1\frac{s-0}{1-0}ds=\int\limits_0^1(s)ds= h\left[\frac{s^2}{2}\right]_0^1=\frac{h}{2}$$
Po wstawieniu wyliczonych wspó³czynników do (\ref{WzorKwadratura}) otrzymujemy 
\begin{equation}\label{wzorTrapezowBrakPodzialu}
\begin{array}{cc}
\int\limits_a^b f(x) dx \approx \sum\limits_{i=0}^1 a_if(x_i)=a_0f(x_0)+a_1f(x_1)=\\
=\frac{h}{2}f(x_0)+\frac{h}{2}f(x_1)=\frac{h}{2}(f(x_0)+f(x_1))
\end{array}
\end{equation}
Wzór ten nazywamy \textbf{wzorem trapezów}. Zauwa¿my, ¿e suma wspó³czynników $\alpha_0$,$\alpha_1$ jest równa $h\cdot n$. W póŸniejszych podrozdzia³ach równie¿ zetkniemy siê z tak¹ prawid³owoœci¹ rozpatruj¹c wy¿szy rz¹d wielomianów \textit{Lagrange'a} dla $n>1$.
%Gdybyœmy wyliczali wspó³czynniki dla $n=2$, to otrzymalibyœmy wzór \textit{Simpsona}

Podczas wyznaczania (\ref{wzorTrapezowBrakPodzialu}) przyjêliœmy, ¿e przedzia³ ca³kowania nie zosta³ podzielony, a jedynymi wêz³ami by³y jego pocz¹tek i koniec. W rzeczywistoœci rozpatrujemy przypadki z wielokrotnym podzia³em przedzia³u. %Dzieje siê tak, poniewa¿ im wiêcej podzia³ów dokonamy tym dok³adniejszy bêdzie uzyskany wynik. 
Je¿eli przedzia³ ca³kowania $[a,b]$ podzielimy na $\geq 2$ równe czêœci takie, ¿e $a=x_0<x_1<\ldots<x_n=b$, to wzór przyjmie postaæ:
\begin{equation}\label{OgolnyWzorTrapezow}
\begin{array}{cc}
\int\limits_a^b f(x)dx=\sum\limits_{i=0}^{n-1}\int\limits_{x_i}^{x_{i+1}}f(x)dx\approx\\ \approx(\frac{h}{2}(f(x_0)+f(x_1))+\cdots+\frac{h}{2}(f(x_{n-1})+f(x_n)))=\\
=\frac{h}{2}(f(x_0)+2f(x_1)+\cdots+2f(x_{n-1})+f(x_n))=\\ 
=\frac{h}{2}\sum\limits_{i=0}^{n-1}[f(x_i)+f(x_{i+1})]
\end{array}
\end{equation}


W wyprowadzonym powy¿ej wzorze trapezów (jak sama nazwa sugeruje) przybli¿amy wartoœæ ca³ek sumuj¹c pola trapezów o ustalonej wysokoœci $h$ (odleg³oœæ pomiêdzy kolejnymi wêz³ami) i podstawach o d³ugoœci $f(x_i)$ i $f(x_{i+1})$ dla $i=0,1,\ldots,n-1$. Rysunek \ref{R1} z pewnoœci¹ pomo¿e zrozumieæ nam zagadnienie, któremu poœwiêcony jest ten podrozdzia³.

\begin{figure}[H]
		\begin{center}
		\includegraphics[scale=0.13]{R2.eps} 
		\end{center}
	   \caption{Graficzne przedstawienie idei zastosowania wzoru trapezów do ca³kowania}
\label{R1}
\end{figure}


Wyznaczyæ przybli¿on¹ wartoœæ ca³ki $\int\limits_0^1 e^{x^2} dx$ przyjmuj¹c, ¿e przedzia³ dzielimy na n=4 równe czêœci. 

$h=\frac{1-0}{4}=\frac{1}{4}$, $x_0=0$, $x_1=0.25$, $x_2=0.5$, $x_3=0.75$, $x_4=1$.\\ Do rozwi¹zania zadania sorzystamy ze wzoru (\ref{OgolnyWzorTrapezow})\\
\begin{center}
$\int\limits_0^1 e^{x^2} dx=\frac{\frac{1}{4}}{2}(f(x_0)+2f(x_1)+2f(x_2)+2f(x_3)+f(x_4))=$\\
$=\frac{1}{8}(e^0+2e^{\frac{1}{16}}+2e^{\frac{1}{4}}+2e^{\frac{9}{16}}+e)\approx 1.49068$\\
\end{center}
Wartoœæ dok³adna wynosi 1.46265, zatem ró¿nica w wyniku jest nieznaczna. Ponadto im wiêcej podzia³ów przedzia³u wykonamy, tym dok³adniejszy otrzymamy wynik.



\section{Wzór Simpsona}
\section{Wzór 'prostok¹tów'}

